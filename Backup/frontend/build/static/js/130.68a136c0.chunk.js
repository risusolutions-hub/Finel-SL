/*! For license information please see 130.68a136c0.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkrole_based_frontend=self.webpackChunkrole_based_frontend||[]).push([[130],{130(e,t,s){s.r(t),s.d(t,{default:()=>o});var i=s(5043),a=s(5228);const l=(0,a.A)("link-2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);var n=s(9855),c=s(7719);const r=(0,a.A)("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);s(349);var d=s(579);function o(e){let{complaintId:t,customerId:s,description:a,title:o}=e;const[p,h]=(0,i.useState)([]),[u,m]=(0,i.useState)(!1),[x,b]=(0,i.useState)(!1),[y,g]=(0,i.useState)([]);(0,i.useEffect)(()=>{t&&j()},[t]);const j=async()=>{try{const e=await fetch("/api/duplicates/complaints/".concat(t),{credentials:"include"}),s=await e.json();s.success&&g(s.duplicates||[])}catch(e){console.error("Error loading duplicates:",e)}};return(0,d.jsxs)("div",{className:"space-y-4",children:[y.length>0&&(0,d.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,d.jsxs)("h3",{className:"font-bold text-blue-900 mb-3 flex items-center gap-2",children:[(0,d.jsx)(l,{size:18}),"Linked Duplicates (",y.length,")"]}),(0,d.jsx)("div",{className:"space-y-2",children:y.map(e=>(0,d.jsxs)("div",{className:"bg-white rounded p-3 flex items-start justify-between",children:[(0,d.jsxs)("div",{className:"flex-1",children:[(0,d.jsxs)("p",{className:"font-medium text-slate-900",children:["Complaint #",e.duplicateComplaintId]}),e.linkReason&&(0,d.jsx)("p",{className:"text-sm text-slate-600",children:e.linkReason})]}),(0,d.jsx)("button",{onClick:()=>(async e=>{try{(await fetch("/api/duplicates/link/".concat(e),{method:"DELETE",credentials:"include"})).ok&&j()}catch(t){console.error("Error unlinking duplicate:",t)}})(e.id),className:"p-2 text-red-600 hover:bg-red-50 rounded transition",children:(0,d.jsx)(n.A,{size:16})})]},e.id))})]}),(0,d.jsx)("div",{className:"bg-white border border-slate-200 rounded-lg p-4",children:(0,d.jsxs)("button",{onClick:async()=>{try{m(!0);const e=await fetch("/api/duplicates/detect",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({customerId:s,description:a,title:o})}),t=await e.json();t.success&&(h(t.potentialDuplicates||[]),b(t.hasDuplicates))}catch(e){console.error("Error detecting duplicates:",e)}finally{m(!1)}},disabled:u,className:"w-full px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 disabled:opacity-50 transition flex items-center justify-center gap-2",children:[(0,d.jsx)(c.A,{size:18}),u?"Checking...":"Check for Similar Complaints"]})}),p.length>0&&(0,d.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[(0,d.jsxs)("h3",{className:"font-bold text-yellow-900 mb-3 flex items-center gap-2",children:[(0,d.jsx)(c.A,{size:18}),"Potential Duplicates Found (",p.length,")"]}),(0,d.jsx)("div",{className:"space-y-2",children:p.map(e=>(0,d.jsxs)("div",{className:"bg-white rounded p-3 flex items-start justify-between",children:[(0,d.jsxs)("div",{className:"flex-1",children:[(0,d.jsxs)("p",{className:"font-medium text-slate-900",children:["Complaint #",e.id,": ",e.title]}),(0,d.jsx)("p",{className:"text-sm text-slate-600 mt-1",children:e.description}),(0,d.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,d.jsxs)("span",{className:"text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded",children:["Status: ",e.status]}),(0,d.jsxs)("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded",children:[e.similarityScore,"% match"]})]})]}),(0,d.jsxs)("button",{onClick:()=>(async e=>{try{(await fetch("/api/duplicates/link",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({primaryComplaintId:t,duplicateComplaintId:e,linkReason:"Auto-detected similar complaint"})})).ok&&(h(p.filter(t=>t.id!==e)),j())}catch(s){console.error("Error linking duplicate:",s)}})(e.id),className:"px-3 py-2 bg-orange-600 text-white rounded hover:bg-orange-700 transition flex items-center gap-1 whitespace-nowrap ml-2",children:[(0,d.jsx)(r,{size:14})," Link"]})]},e.id))})]}),!1===x&&0===p.length&&!u&&(0,d.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 text-center",children:(0,d.jsx)("p",{className:"text-green-700 font-medium",children:"No similar complaints found"})})]})}}}]);
//# sourceMappingURL=130.68a136c0.chunk.js.map