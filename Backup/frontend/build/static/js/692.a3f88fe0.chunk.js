"use strict";(self.webpackChunkrole_based_frontend=self.webpackChunkrole_based_frontend||[]).push([[692],{6692(e,s,t){t.r(s),t.d(s,{default:()=>o});var l=t(9379),a=t(5043),i=t(2054),d=t(5088),r=t(9493),n=t(1360),c=t(73),x=t(579);function o(e){let{users:s,appState:t,setModal:o,user:m}=e;const h=t.engineers||[],p=s||[],[f,b]=(0,a.useState)({}),j=h.map(e=>{const s=p.find(s=>s.id===e.id||String(s.id)===String(e.id)),t=(null===s||void 0===s?void 0:s.activeTime)||0,a=(null===s||void 0===s?void 0:s.isCheckedIn)||!1,i=void 0!==f[e.id]?f[e.id]:t;return(0,l.A)((0,l.A)((0,l.A)({},e),s),{},{isCheckedIn:a,activeTime:i,baseActiveTime:t,lastCheckIn:null===s||void 0===s?void 0:s.lastCheckIn,lastCheckOut:null===s||void 0===s?void 0:s.lastCheckOut})});(0,a.useEffect)(()=>{const e=setInterval(()=>{b(e=>{const s=(0,l.A)({},e);return j.forEach(e=>{if(e.isCheckedIn&&e.lastCheckIn){const t=new Date(e.lastCheckIn).getTime(),l=(new Date).getTime(),a=Math.floor((l-t)/6e4);s[e.id]=e.baseActiveTime+a}}),s})},6e4);return()=>clearInterval(e)},[j]);const g=j.filter(e=>e.isCheckedIn),u=j.filter(e=>!e.isCheckedIn),N=g.reduce((e,s)=>e+(s.activeTime||0),0),v=g.length>0?Math.floor(N/g.length):0,w=e=>{const s=Math.floor(e/60),t=e%60;return"".concat(s,"h ").concat(t,"m")},y=e=>{if(!e)return"N/A";return new Date(e).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0})};return(0,x.jsxs)("div",{className:"space-y-6",children:[(0,x.jsxs)("div",{className:"flex items-center justify-between pb-4 border-b border-slate-200",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("h2",{className:"text-xl font-bold text-slate-900",children:"Engineer Status & Analytics"}),(0,x.jsx)("p",{className:"text-sm text-slate-500",children:"Real-time attendance and activity monitoring"})]}),(0,x.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,x.jsxs)("span",{className:"px-3 py-1 bg-emerald-50 text-emerald-700 text-xs font-bold uppercase rounded-md border border-emerald-100 flex items-center gap-1",children:[(0,x.jsx)("span",{className:"w-2 h-2 rounded-full bg-emerald-500 animate-pulse"}),"Live Updates"]}),"engineer"!==(null===m||void 0===m?void 0:m.role)&&(0,x.jsxs)("button",{onClick:()=>o("complaint"),className:"bg-indigo-600 text-white px-4 py-2 rounded-md text-xs font-medium flex items-center gap-2 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-1 transition-colors shadow-sm",title:"Create New Ticket",children:[(0,x.jsx)(n.A,{className:"w-4 h-4"}),(0,x.jsx)("span",{className:"hidden sm:inline",children:"New Ticket"})]})]})]}),(0,x.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,x.jsxs)("div",{className:"bg-white rounded-lg border border-slate-200 p-4 shadow-sm",children:[(0,x.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,x.jsx)("p",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Total Engineers"}),(0,x.jsx)(c.A,{className:"w-4 h-4 text-slate-400"})]}),(0,x.jsx)("p",{className:"text-2xl font-bold text-slate-900",children:h.length}),(0,x.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"Active in system"})]}),(0,x.jsxs)("div",{className:"bg-white rounded-lg border border-slate-200 p-4 shadow-sm",children:[(0,x.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,x.jsx)("p",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Checked In"}),(0,x.jsx)(i.A,{className:"w-4 h-4 text-emerald-600"})]}),(0,x.jsx)("p",{className:"text-2xl font-bold text-slate-900",children:g.length}),(0,x.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"Working now"})]}),(0,x.jsxs)("div",{className:"bg-white rounded-lg border border-slate-200 p-4 shadow-sm",children:[(0,x.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,x.jsx)("p",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Checked Out"}),(0,x.jsx)(r.A,{className:"w-4 h-4 text-slate-400"})]}),(0,x.jsx)("p",{className:"text-2xl font-bold text-slate-900",children:u.length}),(0,x.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"Off duty"})]}),(0,x.jsxs)("div",{className:"bg-white rounded-lg border border-slate-200 p-4 shadow-sm",children:[(0,x.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,x.jsx)("p",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Avg Active Time"}),(0,x.jsx)(d.A,{className:"w-4 h-4 text-amber-500"})]}),(0,x.jsx)("p",{className:"text-2xl font-bold text-slate-900",children:w(v)}),(0,x.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"For checked-in staff"})]})]}),(0,x.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,x.jsxs)("div",{className:"bg-white rounded-lg border border-slate-200 shadow-sm overflow-hidden flex flex-col h-full",children:[(0,x.jsxs)("div",{className:"px-6 py-4 border-b border-slate-200 bg-emerald-50/30 flex justify-between items-center",children:[(0,x.jsxs)("h3",{className:"font-bold text-slate-900 text-sm uppercase flex items-center gap-2",children:[(0,x.jsx)(i.A,{className:"w-4 h-4 text-emerald-600"}),"Active Staff"]}),(0,x.jsx)("span",{className:"text-xs font-mono font-bold bg-white border border-slate-200 px-2 py-0.5 rounded text-slate-600",children:g.length})]}),(0,x.jsx)("div",{className:"overflow-x-auto flex-1",children:(0,x.jsxs)("table",{className:"w-full text-left text-sm",children:[(0,x.jsx)("thead",{className:"bg-slate-50 text-slate-500 text-xs uppercase font-bold border-b border-slate-200",children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{className:"px-6 py-3 font-semibold tracking-wider",children:"Engineer"}),(0,x.jsx)("th",{className:"px-6 py-3 font-semibold tracking-wider",children:"Check In"}),(0,x.jsx)("th",{className:"px-6 py-3 font-semibold tracking-wider text-right",children:"Duration"})]})}),(0,x.jsx)("tbody",{className:"divide-y divide-slate-100",children:g.length>0?g.map(e=>(0,x.jsxs)("tr",{className:"hover:bg-slate-50",children:[(0,x.jsxs)("td",{className:"px-6 py-3",children:[(0,x.jsx)("div",{className:"font-semibold text-slate-900",children:e.name}),(0,x.jsx)("div",{className:"text-xs text-slate-400",children:e.email})]}),(0,x.jsx)("td",{className:"px-6 py-3 text-emerald-700 font-medium whitespace-nowrap",children:y(e.lastCheckIn)}),(0,x.jsx)("td",{className:"px-6 py-3 text-right font-mono text-slate-700 font-medium",children:w(e.activeTime||0)})]},e.id)):(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:"3",className:"px-6 py-8 text-center text-slate-400 italic",children:"No engineers currently checked in"})})})]})})]}),(0,x.jsxs)("div",{className:"bg-white rounded-lg border border-slate-200 shadow-sm overflow-hidden flex flex-col h-full",children:[(0,x.jsxs)("div",{className:"px-6 py-4 border-b border-slate-200 bg-slate-50/50 flex justify-between items-center",children:[(0,x.jsxs)("h3",{className:"font-bold text-slate-900 text-sm uppercase flex items-center gap-2",children:[(0,x.jsx)(r.A,{className:"w-4 h-4 text-slate-400"}),"Off Duty Staff"]}),(0,x.jsx)("span",{className:"text-xs font-mono font-bold bg-white border border-slate-200 px-2 py-0.5 rounded text-slate-600",children:u.length})]}),(0,x.jsx)("div",{className:"overflow-x-auto flex-1",children:(0,x.jsxs)("table",{className:"w-full text-left text-sm",children:[(0,x.jsx)("thead",{className:"bg-slate-50 text-slate-500 text-xs uppercase font-bold border-b border-slate-200",children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{className:"px-6 py-3 font-semibold tracking-wider",children:"Engineer"}),(0,x.jsx)("th",{className:"px-6 py-3 font-semibold tracking-wider",children:"Last Out"}),(0,x.jsx)("th",{className:"px-6 py-3 font-semibold tracking-wider text-right",children:"Today's Total"})]})}),(0,x.jsx)("tbody",{className:"divide-y divide-slate-100",children:u.length>0?u.map(e=>(0,x.jsxs)("tr",{className:"hover:bg-slate-50",children:[(0,x.jsxs)("td",{className:"px-6 py-3",children:[(0,x.jsx)("div",{className:"font-semibold text-slate-900",children:e.name}),(0,x.jsx)("div",{className:"text-xs text-slate-400",children:e.email})]}),(0,x.jsx)("td",{className:"px-6 py-3 text-slate-500 font-medium whitespace-nowrap",children:y(e.lastCheckOut)}),(0,x.jsx)("td",{className:"px-6 py-3 text-right font-mono text-slate-700 font-medium",children:w(e.activeTime||0)})]},e.id)):(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:"3",className:"px-6 py-8 text-center text-slate-400 italic",children:"All engineers are currently active!"})})})]})})]})]})]})}}}]);
//# sourceMappingURL=692.a3f88fe0.chunk.js.map