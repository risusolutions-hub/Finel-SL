/*! For license information please see 439.70591ec7.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkrole_based_frontend=self.webpackChunkrole_based_frontend||[]).push([[439],{439(e,s,t){t.r(s),t.d(s,{default:()=>c});var a=t(5043),l=t(2054),r=t(6245),d=t(5088),n=t(1360),i=t(674),o=t(579);function c(e){var s;let{leaves:t,user:c,onApprove:x,onReject:m,onRefresh:p,setModal:b}=e;const[h,u]=(0,a.useState)(null),[j,f]=(0,a.useState)(""),[g,v]=(0,a.useState)(null),N=e=>{if(!e)return"N/A";return new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},y=t.filter(e=>"pending"===e.status),w=t.filter(e=>"approved"===e.status),k=t.filter(e=>"rejected"===e.status),A=e=>{switch(e){case"pending":return(0,o.jsx)("span",{className:"px-2.5 py-0.5 bg-amber-50 text-amber-700 border border-amber-200 rounded text-xs font-medium uppercase tracking-wide",children:"Pending"});case"approved":return(0,o.jsx)("span",{className:"px-2.5 py-0.5 bg-emerald-50 text-emerald-700 border border-emerald-200 rounded text-xs font-medium uppercase tracking-wide",children:"Approved"});case"rejected":return(0,o.jsx)("span",{className:"px-2.5 py-0.5 bg-rose-50 text-rose-700 border border-rose-200 rounded text-xs font-medium uppercase tracking-wide",children:"Rejected"});default:return null}},R=e=>{let{tableLeaves:s,showActions:t}=e;return(0,o.jsx)("div",{className:"overflow-x-auto",children:(0,o.jsxs)("table",{className:"w-full text-left text-sm",children:[(0,o.jsx)("thead",{className:"bg-slate-50 text-slate-500 text-xs uppercase font-bold border-b border-slate-200",children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{className:"px-6 py-3 font-semibold tracking-wider",children:"Engineer"}),(0,o.jsx)("th",{className:"px-6 py-3 font-semibold tracking-wider",children:"Type"}),(0,o.jsx)("th",{className:"px-6 py-3 font-semibold tracking-wider",children:"Period"}),(0,o.jsx)("th",{className:"px-6 py-3 font-semibold tracking-wider",children:"Days"}),(0,o.jsx)("th",{className:"px-6 py-3 font-semibold tracking-wider",children:"Reason"}),(0,o.jsx)("th",{className:"px-6 py-3 font-semibold tracking-wider",children:"Status"}),t&&(0,o.jsx)("th",{className:"px-6 py-3 font-semibold tracking-wider text-right",children:"Actions"})]})}),(0,o.jsx)("tbody",{className:"divide-y divide-slate-100",children:s.length>0?s.map(e=>{var s,a;return(0,o.jsxs)("tr",{className:"hover:bg-slate-50",children:[(0,o.jsxs)("td",{className:"px-6 py-3",children:[(0,o.jsx)("div",{className:"font-semibold text-slate-900",children:(null===(s=e.engineer)||void 0===s?void 0:s.name)||"N/A"}),(0,o.jsx)("div",{className:"text-xs text-slate-400",children:null===(a=e.engineer)||void 0===a?void 0:a.email})]}),(0,o.jsx)("td",{className:"px-6 py-3",children:(0,o.jsx)("span",{className:"font-semibold text-slate-600 capitalize",children:e.leaveType})}),(0,o.jsx)("td",{className:"px-6 py-3",children:(0,o.jsxs)("div",{className:"flex flex-col text-xs",children:[(0,o.jsx)("span",{className:"font-medium text-slate-700",children:N(e.startDate)}),(0,o.jsxs)("span",{className:"text-slate-400",children:["to ",N(e.endDate)]})]})}),(0,o.jsxs)("td",{className:"px-6 py-3",children:[(0,o.jsx)("span",{className:"font-bold text-slate-900",children:e.numDays}),(0,o.jsx)("span",{className:"text-xs text-slate-500 ml-1",children:"days"})]}),(0,o.jsx)("td",{className:"px-6 py-3 max-w-xs",children:(0,o.jsx)("p",{className:"text-slate-600 truncate text-xs",title:e.reason,children:e.reason})}),(0,o.jsx)("td",{className:"px-6 py-3",children:A(e.status)}),t&&(0,o.jsx)("td",{className:"px-6 py-3 text-right",children:(0,o.jsx)("button",{onClick:()=>u(e),className:"px-3 py-1 bg-white border border-slate-200 text-slate-700 text-xs font-semibold rounded hover:bg-slate-50 hover:text-blue-600 hover:border-blue-200 transition-all",children:"Review"})})]},e.id)}):(0,o.jsx)("tr",{children:(0,o.jsx)("td",{colSpan:t?7:6,className:"px-6 py-8 text-center text-slate-400 italic",children:"No leave requests found"})})})]})})};return(0,o.jsxs)("div",{className:"space-y-6",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between pb-4 border-b border-slate-200",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("h2",{className:"text-xl font-bold text-slate-900",children:"Leave Management"}),(0,o.jsx)("p",{className:"text-sm text-slate-500",children:"Review and manage engineer time-off requests"})]}),b&&"engineer"!==(null===c||void 0===c?void 0:c.role)&&(0,o.jsxs)("button",{onClick:()=>b("complaint"),className:"bg-indigo-600 text-white px-4 py-2 rounded-md text-xs font-medium flex items-center gap-2 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-1 transition-colors shadow-sm",title:"Create New Ticket",children:[(0,o.jsx)(n.A,{className:"w-4 h-4"}),(0,o.jsx)("span",{className:"hidden sm:inline",children:"New Ticket"})]})]}),(0,o.jsxs)("div",{className:"bg-white rounded-lg border border-slate-200 shadow-sm overflow-hidden",children:[(0,o.jsxs)("div",{className:"px-6 py-4 border-b border-slate-200 bg-amber-50/30 flex justify-between items-center",children:[(0,o.jsxs)("h3",{className:"font-bold text-slate-900 text-sm uppercase flex items-center gap-2",children:[(0,o.jsx)(d.A,{className:"w-4 h-4 text-amber-600"}),"Pending Requests"]}),(0,o.jsx)("span",{className:"text-xs font-mono font-bold bg-white border border-slate-200 px-2 py-0.5 rounded text-slate-600",children:y.length})]}),(0,o.jsx)(R,{tableLeaves:y,showActions:!0})]}),(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,o.jsxs)("div",{className:"bg-white rounded-lg border border-slate-200 shadow-sm overflow-hidden",children:[(0,o.jsxs)("div",{className:"px-6 py-4 border-b border-slate-200 bg-emerald-50/30 flex justify-between items-center",children:[(0,o.jsxs)("h3",{className:"font-bold text-slate-900 text-sm uppercase flex items-center gap-2",children:[(0,o.jsx)(l.A,{className:"w-4 h-4 text-emerald-600"}),"Approved History"]}),(0,o.jsx)("span",{className:"text-xs font-mono font-bold bg-white border border-slate-200 px-2 py-0.5 rounded text-slate-600",children:w.length})]}),(0,o.jsx)(R,{tableLeaves:w,showActions:!1})]}),(0,o.jsxs)("div",{className:"bg-white rounded-lg border border-slate-200 shadow-sm overflow-hidden",children:[(0,o.jsxs)("div",{className:"px-6 py-4 border-b border-slate-200 bg-rose-50/30 flex justify-between items-center",children:[(0,o.jsxs)("h3",{className:"font-bold text-slate-900 text-sm uppercase flex items-center gap-2",children:[(0,o.jsx)(r.A,{className:"w-4 h-4 text-rose-600"}),"Rejected History"]}),(0,o.jsx)("span",{className:"text-xs font-mono font-bold bg-white border border-slate-200 px-2 py-0.5 rounded text-slate-600",children:k.length})]}),(0,o.jsx)(R,{tableLeaves:k,showActions:!1})]})]}),h&&(0,o.jsx)("div",{className:"fixed inset-0 bg-slate-900/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,o.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full border border-slate-200",children:[(0,o.jsxs)("div",{className:"px-6 py-4 border-b border-slate-200 flex justify-between items-center bg-slate-50 rounded-t-lg",children:[(0,o.jsx)("h3",{className:"text-sm font-bold text-slate-900 uppercase tracking-wide",children:"Review Leave Request"}),(0,o.jsx)("button",{onClick:()=>u(null),className:"text-slate-400 hover:text-slate-600",children:(0,o.jsx)(r.A,{className:"w-5 h-5"})})]}),(0,o.jsxs)("div",{className:"p-6 space-y-4",children:[(0,o.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{className:"text-xs text-slate-500 uppercase font-bold mb-1",children:"Engineer"}),(0,o.jsx)("p",{className:"font-bold text-slate-900 text-sm",children:null===(s=h.engineer)||void 0===s?void 0:s.name})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{className:"text-xs text-slate-500 uppercase font-bold mb-1",children:"Leave Type"}),(0,o.jsx)("p",{className:"font-bold text-slate-900 text-sm capitalize",children:h.leaveType})]})]}),(0,o.jsxs)("div",{className:"bg-slate-50 p-3 rounded border border-slate-200",children:[(0,o.jsx)("p",{className:"text-xs text-slate-500 uppercase font-bold mb-1",children:"Requested Period"}),(0,o.jsxs)("div",{className:"flex justify-between items-end",children:[(0,o.jsxs)("p",{className:"font-bold text-slate-900 text-sm",children:[N(h.startDate)," - ",N(h.endDate)]}),(0,o.jsxs)("span",{className:"text-xs font-bold bg-blue-100 text-blue-700 px-2 py-0.5 rounded",children:[h.numDays," Days"]})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{className:"text-xs text-slate-500 uppercase font-bold mb-1",children:"Reason provided"}),(0,o.jsxs)("div",{className:"p-3 bg-slate-50 border border-slate-200 rounded text-sm text-slate-700 italic",children:['"',h.reason,'"']})]}),(0,o.jsxs)("div",{className:"pt-2 border-t border-slate-100",children:[(0,o.jsx)("label",{className:"block text-xs text-slate-500 uppercase font-bold mb-2",children:"Approval Notes (Optional)"}),(0,o.jsx)("textarea",{value:j,onChange:e=>f(e.target.value),placeholder:"Reason for rejection or approval note...",className:"w-full px-3 py-2 border border-slate-300 rounded text-sm focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition-all placeholder:text-slate-400",rows:"3"})]}),(0,o.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,o.jsx)("button",{onClick:()=>{u(null),f("")},className:"flex-1 px-4 py-2 border border-slate-300 rounded-md text-slate-700 text-sm font-semibold hover:bg-slate-50 transition-all",children:"Cancel"}),(0,o.jsx)("button",{onClick:()=>(async e=>{v(e);try{const s=await i.A.post("/leaves/".concat(e,"/reject"),{approvalNotes:j});f(""),u(null),m(s.data),p()}catch(a){var s,t;alert("Error rejecting leave: "+((null===(s=a.response)||void 0===s||null===(t=s.data)||void 0===t?void 0:t.error)||a.message))}finally{v(null)}})(h.id),disabled:g===h.id,className:"flex-1 px-4 py-2 bg-rose-600 hover:bg-rose-700 disabled:bg-rose-400 text-white text-sm font-semibold rounded-md transition-all shadow-sm",children:g===h.id?"Processing...":"Reject"}),(0,o.jsx)("button",{onClick:()=>(async e=>{v(e);try{const s=await i.A.post("/leaves/".concat(e,"/approve"),{approvalNotes:j});f(""),u(null),x(s.data),p()}catch(a){var s,t;alert("Error approving leave: "+((null===(s=a.response)||void 0===s||null===(t=s.data)||void 0===t?void 0:t.error)||a.message))}finally{v(null)}})(h.id),disabled:g===h.id,className:"flex-1 px-4 py-2 bg-emerald-600 hover:bg-emerald-700 disabled:bg-emerald-400 text-white text-sm font-semibold rounded-md transition-all shadow-sm",children:g===h.id?"Processing...":"Approve"})]})]})]})})]})}},6245(e,s,t){t.d(s,{A:()=>a});const a=(0,t(5228).A)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])}}]);
//# sourceMappingURL=439.70591ec7.chunk.js.map