/*! For license information please see 705.086828f6.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkrole_based_frontend=self.webpackChunkrole_based_frontend||[]).push([[705],{67(e,t,s){s.d(t,{A:()=>l});const l=(0,s(5228).A)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]])},3705(e,t,s){s.r(t),s.d(t,{default:()=>O});var l=s(5043),a=s(67),n=s(9333),r=s(1680),i=s(7104),o=s(5228);const d=(0,o.A)("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);var c=s(7719),x=s(9761);const m=(0,o.A)("history",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);var u=s(5087),p=s(1360),h=s(614),b=s(6327),v=s(674),g=s(9379),j=s(9292);const f=(0,o.A)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);var N=s(579);function y(e){let{data:t=[],onFilter:s=()=>{},searchFields:a=[],filters:n=[],onSavePreset:r=()=>{},onLoadPreset:i=()=>{},savedPresets:o=[]}=e;const[d,c]=(0,l.useState)(""),[x,m]=(0,l.useState)({}),[u,p]=(0,l.useState)(!1),[b,v]=(0,l.useState)(""),[y,w]=(0,l.useState)(!1);(0,l.useEffect)(()=>{const e=setTimeout(()=>{k()},300);return()=>clearTimeout(e)},[d,x]);const k=()=>{let e=[...t];if(d.trim()){const t=d.toLowerCase();e=e.filter(e=>a.some(s=>{const l=s.split(".").reduce((e,t)=>null===e||void 0===e?void 0:e[t],e);return String(l).toLowerCase().includes(t)}))}Object.entries(x).forEach(t=>{let[s,l]=t;l&&"all"!==l&&(e=e.filter(e=>{const t=n.find(e=>e.key===s);if(!t)return!0;const a=t.key.split(".").reduce((e,t)=>null===e||void 0===e?void 0:e[t],e);return String(a)===String(l)}))}),s(e)},A=Object.values(x).filter(e=>e&&"all"!==e).length;return(0,N.jsxs)("div",{className:"space-y-3 mb-6",children:[(0,N.jsxs)("div",{className:"flex gap-2",children:[(0,N.jsxs)("div",{className:"flex-1 relative",children:[(0,N.jsx)(j.A,{className:"absolute left-3 top-3 w-4 h-4 text-slate-400"}),(0,N.jsx)("input",{type:"text",placeholder:"Search by name, email, status, ID...",value:d,onChange:e=>c(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,N.jsxs)("button",{onClick:()=>p(!u),className:"flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all border ".concat(u||A>0?"bg-blue-50 border-blue-300 text-blue-700":"bg-white border-slate-300 text-slate-700 hover:bg-slate-50"),children:[(0,N.jsx)(f,{className:"w-4 h-4"}),"Filters",A>0&&(0,N.jsx)("span",{className:"ml-1 px-2 py-0.5 bg-blue-600 text-white text-xs rounded-full font-bold",children:A})]}),(0,N.jsx)("button",{onClick:()=>w(!0),className:"px-3 py-2 bg-white border border-slate-300 rounded-lg text-sm font-medium text-slate-700 hover:bg-slate-50 transition-all",children:"Save"}),(d||A>0)&&(0,N.jsxs)("button",{onClick:()=>{c(""),m({})},className:"px-3 py-2 bg-white border border-slate-300 rounded-lg text-sm font-medium text-slate-700 hover:bg-slate-50 transition-all flex items-center gap-1",children:[(0,N.jsx)(h.A,{className:"w-4 h-4"}),"Clear"]})]}),u&&(0,N.jsx)("div",{className:"bg-white border border-slate-200 rounded-lg p-4 space-y-4",children:(0,N.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:n.map(e=>(0,N.jsxs)("div",{children:[(0,N.jsx)("p",{className:"text-xs font-bold text-slate-600 uppercase mb-2",children:e.label}),(0,N.jsx)("div",{className:"space-y-1",children:e.options.map(t=>(0,N.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer hover:bg-slate-50 p-1 rounded",children:[(0,N.jsx)("input",{type:"checkbox",checked:x[e.key]===t.value,onChange:()=>{return s=e.key,l=t.value,void m(e=>(0,g.A)((0,g.A)({},e),{},{[s]:e[s]===l?"all":l}));var s,l},className:"rounded"}),(0,N.jsx)("span",{className:"text-sm text-slate-700",children:t.label})]},t.value))})]},e.key))})}),o&&o.length>0&&(0,N.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,N.jsx)("span",{className:"text-xs font-bold text-slate-500 uppercase self-center",children:"Presets:"}),o.map((e,t)=>(0,N.jsx)("button",{onClick:()=>i(e),className:"px-3 py-1 bg-blue-50 border border-blue-200 rounded text-xs font-medium text-blue-700 hover:bg-blue-100 transition-all",children:e.name},t))]}),y&&(0,N.jsx)("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center z-50 rounded-lg",children:(0,N.jsxs)("div",{className:"bg-white rounded-lg p-4 shadow-lg max-w-sm w-full m-4",children:[(0,N.jsx)("h3",{className:"text-sm font-bold text-slate-900 mb-3",children:"Save Filter Preset"}),(0,N.jsx)("input",{type:"text",placeholder:"Enter preset name...",value:b,onChange:e=>v(e.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 mb-3"}),(0,N.jsxs)("div",{className:"flex gap-2",children:[(0,N.jsx)("button",{onClick:()=>w(!1),className:"flex-1 px-3 py-2 border border-slate-300 rounded text-sm font-medium text-slate-700 hover:bg-slate-50",children:"Cancel"}),(0,N.jsx)("button",{onClick:()=>{b.trim()&&(r({name:b,searchTerm:d,filters:x,timestamp:(new Date).toISOString()}),v(""),w(!1))},className:"flex-1 px-3 py-2 bg-blue-600 rounded text-sm font-medium text-white hover:bg-blue-700",children:"Save"})]})]})})]})}const w=(0,o.A)("file-spreadsheet",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]),k=(0,o.A)("file",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}]]),A=(e,t)=>{const s=document.createElement("a"),l=URL.createObjectURL(e);s.setAttribute("href",l),s.setAttribute("download",t),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s)};function C(e){let{data:t=[],filename:a="export",title:n="Export Data",columns:o=null,compact:d=!1}=e;const[c,x]=(0,l.useState)(!1),[m,u]=(0,l.useState)(!1),p=async e=>{u(!0);try{const l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"export";const t=(new Date).toISOString().slice(0,10);return"".concat(e,"-").concat(t)}(a);switch(e){case"csv":!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"export.csv",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e||0===e.length)return void alert("No data to export");const l=s||Object.keys(e[0]),a=[l.join(","),...e.map(e=>l.map(t=>{const s=t.split(".").reduce((e,t)=>null===e||void 0===e?void 0:e[t],e)||"",l=String(s).replace(/"/g,'""');return l.includes(",")?'"'.concat(l,'"'):l}).join(","))].join("\n"),n=new Blob([a],{type:"text/csv;charset=utf-8;"});A(n,t)}(t,"".concat(l,".csv"),o);break;case"json":!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"export.json";if(!e||0===e.length)return void alert("No data to export");const s=JSON.stringify(e,null,2),l=new Blob([s],{type:"application/json"});A(l,t)}(t,"".concat(l,".json"));break;case"excel":await async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"export.xlsx",l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Sheet1";if(e&&0!==e.length)try{const a=await s.e(238).then(s.bind(s,1238)),n=a.utils.json_to_sheet(e),r=a.utils.book_new();a.utils.book_append_sheet(r,n,l),a.writeFile(r,t)}catch(a){alert("Please install xlsx library: npm install xlsx"),console.error("Excel export error:",a)}else alert("No data to export")}(t,"".concat(l,".xlsx"));break;case"pdf":await async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"export.pdf",l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Report";if(e&&0!==e.length)try{const a=await s.e(389).then(s.bind(s,1389)),n=(await s.e(857).then(s.bind(s,4857)),new a.jsPDF);n.setFontSize(16),n.text(l,14,15),n.setFontSize(10),n.text("Generated: ".concat((new Date).toLocaleString()),14,25);const r=Object.keys(e[0]),i=e.map(e=>r.map(t=>{const s=t.split(".").reduce((e,t)=>null===e||void 0===e?void 0:e[t],e)||"";return String(s).substring(0,50)}));n.autoTable({head:[r],body:i,startY:35,styles:{fontSize:9},columnStyles:{0:{cellWidth:20}}}),n.save(t)}catch(a){alert("Please install PDF libraries: npm install jspdf jspdf-autotable"),console.error("PDF export error:",a)}else alert("No data to export")}(t,"".concat(l,".pdf"),n)}x(!1)}catch(l){console.error("Export error:",l)}finally{u(!1)}};return d?(0,N.jsxs)("div",{className:"relative inline-block",children:[(0,N.jsxs)("button",{onClick:()=>x(!c),className:"flex items-center gap-1 px-3 py-2 bg-white border border-slate-300 rounded-lg text-sm font-medium text-slate-700 hover:bg-slate-50 transition-all",children:[(0,N.jsx)(i.A,{className:"w-4 h-4"}),"Export"]}),c&&(0,N.jsxs)("div",{className:"absolute right-0 mt-1 w-40 bg-white border border-slate-200 rounded-lg shadow-lg z-10",children:[(0,N.jsxs)("button",{onClick:()=>p("csv"),disabled:m,className:"w-full text-left px-4 py-2 text-sm text-slate-700 hover:bg-slate-50 flex items-center gap-2 first:rounded-t last:rounded-b",children:[(0,N.jsx)(r.A,{className:"w-4 h-4"})," CSV"]}),(0,N.jsxs)("button",{onClick:()=>p("excel"),disabled:m,className:"w-full text-left px-4 py-2 text-sm text-slate-700 hover:bg-slate-50 flex items-center gap-2",children:[(0,N.jsx)(w,{className:"w-4 h-4"})," Excel"]}),(0,N.jsxs)("button",{onClick:()=>p("json"),disabled:m,className:"w-full text-left px-4 py-2 text-sm text-slate-700 hover:bg-slate-50 flex items-center gap-2",children:[(0,N.jsx)(k,{className:"w-4 h-4"})," JSON"]}),(0,N.jsxs)("button",{onClick:()=>p("pdf"),disabled:m,className:"w-full text-left px-4 py-2 text-sm text-slate-700 hover:bg-slate-50 flex items-center gap-2 last:rounded-b",children:[(0,N.jsx)(r.A,{className:"w-4 h-4"})," PDF"]})]})]}):(0,N.jsxs)("div",{className:"bg-white rounded-lg border border-slate-200 p-6 shadow-sm",children:[(0,N.jsxs)("h3",{className:"text-sm font-bold text-slate-900 mb-4 flex items-center gap-2",children:[(0,N.jsx)(i.A,{className:"w-5 h-5"}),"Export Options"]}),(0,N.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,N.jsxs)("button",{onClick:()=>p("csv"),disabled:m||0===t.length,className:"flex flex-col items-center justify-center p-4 border border-slate-200 rounded-lg hover:bg-slate-50 disabled:opacity-50 transition-all",children:[(0,N.jsx)(r.A,{className:"w-6 h-6 text-blue-600 mb-2"}),(0,N.jsx)("span",{className:"text-xs font-medium text-slate-900",children:"CSV"}),(0,N.jsx)("span",{className:"text-[10px] text-slate-500 mt-1",children:"Spreadsheet"})]}),(0,N.jsxs)("button",{onClick:()=>p("excel"),disabled:m||0===t.length,className:"flex flex-col items-center justify-center p-4 border border-slate-200 rounded-lg hover:bg-slate-50 disabled:opacity-50 transition-all",children:[(0,N.jsx)(w,{className:"w-6 h-6 text-emerald-600 mb-2"}),(0,N.jsx)("span",{className:"text-xs font-medium text-slate-900",children:"Excel"}),(0,N.jsx)("span",{className:"text-[10px] text-slate-500 mt-1",children:"XLSX Format"})]}),(0,N.jsxs)("button",{onClick:()=>p("json"),disabled:m||0===t.length,className:"flex flex-col items-center justify-center p-4 border border-slate-200 rounded-lg hover:bg-slate-50 disabled:opacity-50 transition-all",children:[(0,N.jsx)(k,{className:"w-6 h-6 text-amber-600 mb-2"}),(0,N.jsx)("span",{className:"text-xs font-medium text-slate-900",children:"JSON"}),(0,N.jsx)("span",{className:"text-[10px] text-slate-500 mt-1",children:"Data Format"})]}),(0,N.jsxs)("button",{onClick:()=>p("pdf"),disabled:m||0===t.length,className:"flex flex-col items-center justify-center p-4 border border-slate-200 rounded-lg hover:bg-slate-50 disabled:opacity-50 transition-all",children:[(0,N.jsx)(r.A,{className:"w-6 h-6 text-rose-600 mb-2"}),(0,N.jsx)("span",{className:"text-xs font-medium text-slate-900",children:"PDF"}),(0,N.jsx)("span",{className:"text-[10px] text-slate-500 mt-1",children:"Document"})]})]}),0===t.length&&(0,N.jsx)("p",{className:"text-xs text-slate-500 text-center mt-4",children:"No data available to export"})]})}function S(e){let{complaint:t=null,slaDurationHours:s=24}=e;const a=(0,l.useMemo)(()=>{if(!t||!t.createdAt)return{status:"invalid"};const e=new Date(t.createdAt),l=60*s*60*1e3,a=new Date(e.getTime()+l)-new Date;return"resolved"===t.status||"closed"===t.status?{status:"resolved"}:a<=0?{status:"overdue"}:a<=36e5?{status:"critical"}:a<=144e5?{status:"warning"}:{status:"ok"}},[t,s]);return(0,N.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat({ok:"bg-emerald-100 text-emerald-700 border border-emerald-200",warning:"bg-amber-100 text-amber-700 border border-amber-200",critical:"bg-rose-100 text-rose-700 border border-rose-200",overdue:"bg-rose-200 text-rose-800 border border-rose-300",resolved:"bg-slate-100 text-slate-700 border border-slate-200",invalid:"bg-slate-100 text-slate-700 border border-slate-200"}[a.status]),children:{ok:"On Track",warning:"Warning",critical:"Critical",overdue:"Overdue",resolved:"Resolved",invalid:"N/A"}[a.status]})}const D=e=>{let{priority:t}=e;const s={low:"bg-green-100 text-green-700 border-green-200",medium:"bg-yellow-100 text-yellow-700 border-yellow-200",high:"bg-orange-100 text-orange-700 border-orange-200",critical:"bg-red-100 text-red-700 border-red-200"};return(0,N.jsx)("span",{className:"text-[10px] font-bold uppercase px-2 py-1 rounded border ".concat(s[t]||s.medium),children:t||"medium"})},I=e=>{let{categories:t}=e;const s=Array.isArray(t)?t:[];if(0===s.length)return null;const l={electrical:"\u26a1",mechanical:"\u2699\ufe0f",software:"\ud83d\udcbb",cooling:"\u2744\ufe0f",network:"\ud83c\udf10",display:"\ud83d\udda5\ufe0f",power:"\ud83d\udd0c",noise:"\ud83d\udd0a",performance:"\ud83d\udcc9",other:"\ud83d\udccb"};return(0,N.jsxs)("div",{className:"flex flex-wrap gap-1 mt-1",children:[s.slice(0,3).map((e,t)=>{const s=e.startsWith("custom:"),a=s?e.replace("custom:",""):e;return(0,N.jsxs)("span",{className:"text-[9px] px-1.5 py-0.5 bg-slate-100 text-slate-600 rounded",children:[!s&&l[e]," ",a.substring(0,15)]},t)}),s.length>3&&(0,N.jsxs)("span",{className:"text-[9px] px-1.5 py-0.5 bg-slate-100 text-slate-600 rounded",children:["+",s.length-3," more"]})]})},M=e=>{let{attachments:t}=e;const s=Array.isArray(t)?t:[];if(0===s.length)return null;const l=s.some(e=>{var t;return null===(t=e.type)||void 0===t?void 0:t.startsWith("image/")}),i=s.some(e=>{var t;return null===(t=e.type)||void 0===t?void 0:t.startsWith("video/")}),o=s.some(e=>{var t,s;return!(null!==(t=e.type)&&void 0!==t&&t.startsWith("image/"))&&!(null!==(s=e.type)&&void 0!==s&&s.startsWith("video/"))});return(0,N.jsxs)("div",{className:"flex items-center gap-1 mt-1",children:[l&&(0,N.jsx)(a.A,{size:12,className:"text-blue-500"}),i&&(0,N.jsx)(n.A,{size:12,className:"text-purple-500"}),o&&(0,N.jsx)(r.A,{size:12,className:"text-slate-500"}),(0,N.jsxs)("span",{className:"text-[9px] text-slate-500",children:[s.length," file",s.length>1?"s":""]})]})},z=e=>{let{attachments:t}=e;if(!t||0===t.length)return(0,N.jsx)("p",{className:"text-sm text-slate-400 italic",children:"No attachments"});const s=async e=>{try{const t=e.yearMonth&&e.filename?"".concat(v.A.defaults.baseURL,"/uploads/files/").concat(e.yearMonth,"/").concat(e.filename):"".concat(v.A.defaults.baseURL,"/uploads/").concat(e.filename||e.name);window.open(t,"_blank")}catch(t){console.error("Download error:",t)}};return(0,N.jsx)("div",{className:"space-y-2",children:t.map((e,t)=>{var l,o,c;return(0,N.jsxs)("div",{className:"flex items-center gap-3 p-2 bg-slate-50 rounded-lg border border-slate-200",children:[(c=e.type,null!==c&&void 0!==c&&c.startsWith("image/")?(0,N.jsx)(a.A,{size:16,className:"text-blue-500"}):null!==c&&void 0!==c&&c.startsWith("video/")?(0,N.jsx)(n.A,{size:16,className:"text-purple-500"}):(0,N.jsx)(r.A,{size:16,className:"text-slate-500"})),(0,N.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,N.jsx)("p",{className:"text-sm font-medium text-slate-700 truncate",children:e.originalName||e.name||e.filename}),(0,N.jsx)("p",{className:"text-xs text-slate-400",children:(o=e.size,o?o<1024?o+" B":o<1048576?(o/1024).toFixed(1)+" KB":(o/1048576).toFixed(1)+" MB":"")})]}),(0,N.jsx)("button",{onClick:()=>s(e),className:"p-1.5 hover:bg-blue-100 rounded text-blue-600 transition",title:"Download",children:(0,N.jsx)(i.A,{size:14})}),(null===(l=e.type)||void 0===l?void 0:l.startsWith("image/"))&&(0,N.jsx)("button",{onClick:()=>s(e),className:"p-1.5 hover:bg-green-100 rounded text-green-600 transition",title:"View",children:(0,N.jsx)(d,{size:14})})]},t)})})},P=e=>{var t,s,l;let{complaint:a,customer:n,machine:r}=e;if(!a)return null;const i={electrical:"\u26a1 Electrical Issues",mechanical:"\u2699\ufe0f Mechanical Problems",software:"\ud83d\udcbb Software/Firmware",cooling:"\u2744\ufe0f Cooling System",network:"\ud83c\udf10 Network/Connectivity",display:"\ud83d\udda5\ufe0f Display Issues",power:"\ud83d\udd0c Power Supply",noise:"\ud83d\udd0a Unusual Noise",performance:"\ud83d\udcc9 Performance Issues",other:"\ud83d\udccb Other"};return(0,N.jsxs)("div",{className:"p-4 space-y-5",children:[(0,N.jsxs)("div",{className:"flex items-center gap-3",children:[(0,N.jsx)(D,{priority:a.priority}),(0,N.jsx)(b.A,{status:a.status})]}),(0,N.jsxs)("div",{className:"bg-blue-50 rounded-lg p-3 border border-blue-100",children:[(0,N.jsx)("h4",{className:"text-xs font-bold text-blue-700 uppercase mb-2",children:"Customer Details"}),(0,N.jsx)("p",{className:"text-sm font-medium text-slate-900",children:(null===n||void 0===n?void 0:n.company)||(null===n||void 0===n?void 0:n.name)}),(0,N.jsxs)("p",{className:"text-xs text-slate-600",children:["Service No: ",(null===n||void 0===n?void 0:n.serviceNo)||"-"]}),(null===n||void 0===n?void 0:n.contactPerson)&&(0,N.jsxs)("p",{className:"text-xs text-slate-600",children:["Contact: ",n.contactPerson]}),(null===n||void 0===n?void 0:n.phone)&&(0,N.jsxs)("p",{className:"text-xs text-slate-600",children:["\ud83d\udcde ",n.phone]}),(null===n||void 0===n||null===(t=n.phones)||void 0===t?void 0:t.length)>1&&(0,N.jsxs)("p",{className:"text-xs text-slate-500",children:["+ ",n.phones.length-1," more number(s)"]}),(null===n||void 0===n?void 0:n.address)&&(0,N.jsxs)("p",{className:"text-xs text-slate-500 mt-1",children:["\ud83d\udccd ",n.address]})]}),(0,N.jsxs)("div",{className:"bg-purple-50 rounded-lg p-3 border border-purple-100",children:[(0,N.jsx)("h4",{className:"text-xs font-bold text-purple-700 uppercase mb-2",children:"Machine Details"}),(0,N.jsx)("p",{className:"text-sm font-medium text-slate-900",children:null===r||void 0===r?void 0:r.model}),(0,N.jsxs)("p",{className:"text-xs text-slate-600 font-mono",children:["S/N: ",null===r||void 0===r?void 0:r.serialNumber]}),(null===r||void 0===r||null===(s=r.mobileNumbers)||void 0===s?void 0:s.length)>0&&(0,N.jsxs)("div",{className:"mt-2",children:[(0,N.jsx)("p",{className:"text-xs text-slate-500 font-medium",children:"Mobile Numbers:"}),r.mobileNumbers.map((e,t)=>(0,N.jsxs)("p",{className:"text-xs text-slate-600",children:["\ud83d\udcf1 ",e]},t))]})]}),Array.isArray(a.issueCategories)&&a.issueCategories.length>0&&(0,N.jsxs)("div",{children:[(0,N.jsx)("h4",{className:"text-xs font-bold text-slate-700 uppercase mb-2",children:"Issue Categories"}),(0,N.jsx)("div",{className:"flex flex-wrap gap-2",children:a.issueCategories.map((e,t)=>{const s=e.startsWith("custom:")?"\u270f\ufe0f ".concat(e.replace("custom:","")):i[e]||e;return(0,N.jsx)("span",{className:"text-xs px-2 py-1 bg-amber-50 text-amber-700 rounded border border-amber-200",children:s},t)})})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("h4",{className:"text-xs font-bold text-slate-700 uppercase mb-2",children:"Problem Description"}),(0,N.jsx)("p",{className:"text-sm text-slate-700 bg-slate-50 p-3 rounded-lg border border-slate-200 whitespace-pre-wrap",children:a.problem})]}),(0,N.jsxs)("div",{children:[(0,N.jsxs)("h4",{className:"text-xs font-bold text-slate-700 uppercase mb-2",children:["Attachments (",(null===(l=a.attachments)||void 0===l?void 0:l.length)||0,")"]}),(0,N.jsx)(z,{attachments:a.attachments})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("h4",{className:"text-xs font-bold text-slate-700 uppercase mb-2",children:"Timeline"}),(0,N.jsxs)("div",{className:"space-y-2 text-xs",children:[(0,N.jsxs)("div",{className:"flex justify-between",children:[(0,N.jsx)("span",{className:"text-slate-500",children:"Created:"}),(0,N.jsx)("span",{className:"text-slate-700",children:new Date(a.createdAt).toLocaleString()})]}),a.assignedAt&&(0,N.jsxs)("div",{className:"flex justify-between",children:[(0,N.jsx)("span",{className:"text-slate-500",children:"Assigned:"}),(0,N.jsx)("span",{className:"text-slate-700",children:new Date(a.assignedAt).toLocaleString()})]}),a.resolvedAt&&(0,N.jsxs)("div",{className:"flex justify-between",children:[(0,N.jsx)("span",{className:"text-slate-500",children:"Resolved:"}),(0,N.jsx)("span",{className:"text-slate-700",children:new Date(a.resolvedAt).toLocaleString()})]}),a.closedAt&&(0,N.jsxs)("div",{className:"flex justify-between",children:[(0,N.jsx)("span",{className:"text-slate-500",children:"Closed:"}),(0,N.jsx)("span",{className:"text-slate-700",children:new Date(a.closedAt).toLocaleString()})]})]})]})]})},L=(0,l.lazy)(()=>s.e(130).then(s.bind(s,130))),F=(0,l.lazy)(()=>s.e(921).then(s.bind(s,4921))),T=(0,l.lazy)(()=>s.e(553).then(s.bind(s,553)));function O(e){let{complaints:t,customers:s,machines:a,user:n,onAssign:r,onTakeTicket:i,onCancelAssignment:o,onStartWork:d,onComplete:v,onClose:g,setModal:j}=e;const[f,w]=(0,l.useState)(t),[k,A]=(0,l.useState)(null),[z,O]=(0,l.useState)(null),[_,E]=(0,l.useState)(()=>{const e=localStorage.getItem("complaintFilterPresets");return e?JSON.parse(e):[]}),W=e=>{const t="engineer"===(null===n||void 0===n?void 0:n.role),s=e.assignedTo===String(null===n||void 0===n?void 0:n.id),l="manager"===(null===n||void 0===n?void 0:n.role)||"admin"===(null===n||void 0===n?void 0:n.role)||"superadmin"===(null===n||void 0===n?void 0:n.role);if(t){if("pending"===e.status)return(0,N.jsx)("button",{onClick:()=>i(e.id,n.id),className:"text-[10px] font-bold uppercase text-indigo-600 hover:text-indigo-700",children:"Take"});if("assigned"===e.status&&s)return(0,N.jsxs)("div",{className:"flex gap-4",children:[(0,N.jsx)("button",{onClick:()=>o(e.id),className:"text-[10px] font-bold uppercase text-slate-600 hover:text-slate-700",children:"Cancel"}),(0,N.jsx)("button",{onClick:()=>d(e.id,"in_progress"),className:"text-[10px] font-bold uppercase text-blue-600 hover:text-blue-700",children:"Start Work"})]});if("in_progress"===e.status&&s)return(0,N.jsxs)("div",{className:"flex gap-4",children:[(0,N.jsx)("button",{onClick:()=>j({type:"complete",complaint:e}),className:"text-[10px] font-bold uppercase text-emerald-600 hover:text-emerald-700",children:"Complete"}),(0,N.jsx)("button",{onClick:()=>j({type:"close",complaint:e}),className:"text-[10px] font-bold uppercase text-rose-600 hover:text-rose-700",children:"Close"})]})}else if(l){if("pending"===e.status)return(0,N.jsx)("button",{onClick:()=>j({type:"assign",complaint:e}),className:"text-[10px] font-bold uppercase text-indigo-600 hover:text-indigo-700",children:"Assign"});var a,r;if("assigned"===e.status)return(0,N.jsxs)("div",{className:"flex gap-4",children:[(0,N.jsxs)("span",{className:"text-[10px] font-bold text-blue-500",children:["Assigned to ",(null===(a=e.engineer)||void 0===a?void 0:a.name)||"..."]}),(0,N.jsx)("button",{onClick:()=>o(e.id),className:"text-[10px] font-bold uppercase text-rose-600 hover:text-rose-700",children:"Cancel"})]});if("in_progress"===e.status)return(0,N.jsxs)("div",{className:"flex gap-4",children:[(0,N.jsxs)("span",{className:"text-[10px] font-bold text-blue-500",children:["In Progress by ",(null===(r=e.engineer)||void 0===r?void 0:r.name)||"..."]}),(0,N.jsx)("button",{onClick:()=>o(e.id),className:"text-[10px] font-bold uppercase text-rose-600 hover:text-rose-700",children:"Cancel"})]})}return"closed"===e.status||"resolved"===e.status?(0,N.jsx)("span",{className:"text-[10px] font-bold text-slate-400",children:"resolved"===e.status?"Completed":"Closed"}):null},V=(e,t)=>{A(e),O(t)},H=e=>{"manager"===(null===n||void 0===n?void 0:n.role)||"admin"===(null===n||void 0===n?void 0:n.role)||null===n||void 0===n||n.role;return(0,N.jsxs)("div",{className:"flex items-center gap-1",children:[(0,N.jsx)("button",{onClick:()=>V(e,"duplicates"),className:"p-1.5 hover:bg-orange-50 rounded transition text-orange-600",title:"Check Duplicates",children:(0,N.jsx)(c.A,{size:14})}),("in_progress"===e.status||"resolved"===e.status)&&(0,N.jsx)("button",{onClick:()=>V(e,"checklist"),className:"p-1.5 hover:bg-green-50 rounded transition text-green-600",title:"Service Checklist",children:(0,N.jsx)(x.A,{size:14})}),(0,N.jsx)("button",{onClick:()=>V(e,"history"),className:"p-1.5 hover:bg-purple-50 rounded transition text-purple-600",title:"Machine History",children:(0,N.jsx)(m,{size:14})}),(0,N.jsx)("button",{onClick:()=>V(e,"details"),className:"p-1.5 hover:bg-slate-100 rounded transition text-slate-600",title:"View Details",children:(0,N.jsx)(u.A,{size:14})})]})};return(0,N.jsxs)("div",{className:"fade-in flex gap-4",children:[(0,N.jsxs)("div",{className:"flex-1 space-y-4 ".concat(k?"w-2/3":"w-full"),children:[(0,N.jsx)(y,{data:t,onFilter:w,searchFields:["displayId","complaintId","id","problem","engineer.name","engineer.email"],filters:[{key:"status",label:"Status",options:[{value:"pending",label:"Pending"},{value:"assigned",label:"Assigned"},{value:"in_progress",label:"In Progress"},{value:"resolved",label:"Resolved"},{value:"closed",label:"Closed"}]},{key:"priority",label:"Priority",options:[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}]}],onSavePreset:e=>{const t=[..._,e];E(t),localStorage.setItem("complaintFilterPresets",JSON.stringify(t))},onLoadPreset:e=>{window.location.reload()},savedPresets:_}),(0,N.jsx)("div",{className:"flex justify-end",children:(0,N.jsx)(C,{data:f.map(e=>{var t,l,n,r;return{"Case ID":e.displayId||e.complaintId||e.id,Customer:(null===(t=s.find(t=>t.id===e.customerId))||void 0===t?void 0:t.name)||"N/A",Machine:(null===(l=a.find(t=>t.id===e.machineId))||void 0===l?void 0:l.model)||"N/A",Priority:e.priority||"N/A",Status:e.status||"pending","Assigned To":(null===(n=e.engineer)||void 0===n?void 0:n.name)||"Unassigned",Created:new Date(e.createdAt).toLocaleDateString(),Problem:(null===(r=e.problem)||void 0===r?void 0:r.substring(0,100))||""}}),filename:"complaints",title:"Complaint Tickets Export",compact:!0})}),(0,N.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 mb-8",children:[(0,N.jsxs)("div",{className:"px-6 py-4 border-b border-neutral-200 flex items-center justify-between bg-neutral-50",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("h3",{className:"font-semibold text-neutral-900 text-sm",children:"Tickets"}),(0,N.jsxs)("p",{className:"text-xs text-neutral-600 mt-1",children:[f.length," of ",t.length," tickets"]})]}),"engineer"!==(null===n||void 0===n?void 0:n.role)&&(0,N.jsxs)("button",{onClick:()=>j("complaint"),className:"bg-indigo-600 text-white px-4 py-2 rounded-md text-xs font-medium flex items-center gap-2 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-1 transition-colors shadow-sm",children:[(0,N.jsx)(p.A,{className:"w-4 h-4"}),(0,N.jsx)("span",{children:"New Ticket"})]})]}),(0,N.jsx)("div",{className:"overflow-x-auto",children:(0,N.jsxs)("table",{className:"w-full text-left text-sm",children:[(0,N.jsx)("thead",{className:"bg-slate-50 text-slate-500 text-xs font-medium uppercase tracking-wider border-b border-slate-200",children:(0,N.jsxs)("tr",{children:[(0,N.jsx)("th",{className:"px-6 py-3",children:"Case ID"}),(0,N.jsx)("th",{className:"px-6 py-3",children:"Client details"}),(0,N.jsx)("th",{className:"px-6 py-3",children:"Machine info"}),(0,N.jsx)("th",{className:"px-6 py-3",children:"Priority"}),(0,N.jsx)("th",{className:"px-6 py-3",children:"Issue"}),(0,N.jsx)("th",{className:"px-6 py-3",children:"Status"}),(0,N.jsx)("th",{className:"px-6 py-3",children:"SLA"}),(0,N.jsx)("th",{className:"px-6 py-3",children:"Tools"}),(0,N.jsx)("th",{className:"px-6 py-3 text-right",children:"Actions"})]})}),(0,N.jsx)("tbody",{className:"divide-y divide-slate-100",children:f.length>0?f.map(e=>{var t,l,n;const r=s.find(t=>t.id===e.customerId),i=a.find(t=>t.id===e.machineId),o=(null===k||void 0===k?void 0:k.id)===e.id;return(0,N.jsxs)("tr",{className:"hover:bg-slate-50 transition-colors ".concat(o?"bg-blue-50":""),children:[(0,N.jsxs)("td",{className:"px-6 py-4",children:[(0,N.jsx)("span",{className:"font-mono text-xs font-medium text-blue-600 bg-blue-50 px-2 py-1 rounded border border-blue-100",children:e.displayId||e.complaintId||e.id}),(0,N.jsx)(M,{attachments:e.attachments})]}),(0,N.jsxs)("td",{className:"px-6 py-4",children:[(0,N.jsx)("div",{className:"font-medium text-slate-900",children:(null===r||void 0===r?void 0:r.company)||(null===r||void 0===r?void 0:r.name)}),(0,N.jsx)("div",{className:"text-xs text-slate-500 mt-0.5",children:(null===r||void 0===r?void 0:r.serviceNo)||(null===r||void 0===r?void 0:r.city)||(null===r||void 0===r?void 0:r.id)}),(null===r||void 0===r?void 0:r.phone)&&(0,N.jsxs)("div",{className:"text-xs text-slate-400",children:["\ud83d\udcde ",r.phone]})]}),(0,N.jsxs)("td",{className:"px-6 py-4",children:[(0,N.jsx)("div",{className:"text-slate-700 text-sm",children:null===i||void 0===i?void 0:i.model}),(0,N.jsx)("div",{className:"text-xs text-slate-500 font-mono mt-0.5",children:null===i||void 0===i?void 0:i.serialNumber}),(null===i||void 0===i||null===(t=i.mobileNumbers)||void 0===t?void 0:t.length)>0&&(0,N.jsxs)("div",{className:"text-xs text-slate-400",children:["\ud83d\udcf1 ",i.mobileNumbers[0]]})]}),(0,N.jsx)("td",{className:"px-6 py-4",children:(0,N.jsx)(D,{priority:e.priority})}),(0,N.jsxs)("td",{className:"px-6 py-4 max-w-[200px]",children:[(0,N.jsxs)("div",{className:"text-xs text-slate-700 truncate",title:e.problem,children:[null===(l=e.problem)||void 0===l?void 0:l.substring(0,40),(null===(n=e.problem)||void 0===n?void 0:n.length)>40?"...":""]}),(0,N.jsx)(I,{categories:e.issueCategories})]}),(0,N.jsx)("td",{className:"px-6 py-4",children:(0,N.jsx)(b.A,{status:e.status})}),(0,N.jsx)("td",{className:"px-6 py-4",children:(0,N.jsx)(S,{complaint:e,slaDurationHours:24})}),(0,N.jsx)("td",{className:"px-6 py-4",children:H(e)}),(0,N.jsx)("td",{className:"px-6 py-4 text-right",children:W(e)})]},e.id)}):(0,N.jsx)("tr",{children:(0,N.jsx)("td",{colSpan:"9",className:"px-6 py-12 text-center text-slate-400 italic",children:"No tickets match your search criteria"})})})]})})]})]}),k&&z&&(0,N.jsxs)("div",{className:"w-1/3 min-w-[400px] bg-white rounded-xl border border-slate-200 shadow-lg overflow-hidden flex flex-col max-h-[calc(100vh-200px)]",children:[(0,N.jsxs)("div",{className:"p-4 border-b border-slate-200 flex items-center justify-between bg-slate-50",children:[(0,N.jsxs)("div",{children:[(0,N.jsxs)("h3",{className:"font-bold text-slate-900",children:["duplicates"===z&&"Duplicate Detection","checklist"===z&&"Service Checklist","history"===z&&"Machine History","details"===z&&"Ticket Details"]}),(0,N.jsxs)("p",{className:"text-xs text-slate-500",children:["Ticket #",k.displayId||k.complaintId||k.id]})]}),(0,N.jsx)("button",{onClick:()=>{A(null),O(null)},className:"p-2 hover:bg-slate-200 rounded-lg transition",children:(0,N.jsx)(h.A,{size:18,className:"text-slate-500"})})]}),(0,N.jsx)("div",{className:"flex-1 overflow-y-auto",children:(0,N.jsxs)(l.Suspense,{fallback:(0,N.jsx)("div",{className:"p-8 text-center text-slate-400",children:"Loading..."}),children:["duplicates"===z&&(0,N.jsx)("div",{className:"p-4",children:(0,N.jsx)(L,{complaintId:k.id,customerId:k.customerId,description:k.problem,title:k.displayId})}),"checklist"===z&&(0,N.jsx)("div",{className:"p-4",children:(0,N.jsx)(F,{complaintId:k.id,isEngineer:"engineer"===(null===n||void 0===n?void 0:n.role),isManager:["manager","admin","superadmin"].includes(null===n||void 0===n?void 0:n.role)})}),"history"===z&&(0,N.jsx)("div",{className:"p-4",children:(0,N.jsx)(T,{machineId:k.machineId})}),"details"===z&&(0,N.jsx)(P,{complaint:k,customer:s.find(e=>e.id===k.customerId),machine:a.find(e=>e.id===k.machineId)})]})})]})]})}},5087(e,t,s){s.d(t,{A:()=>l});const l=(0,s(5228).A)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},6327(e,t,s){s.d(t,{A:()=>n});s(5043);var l=s(8783),a=s(579);function n(e){let{status:t}=e;const s=l.M2[t]||{label:t,color:"bg-neutral-100 text-neutral-700 border border-neutral-200"};return(0,a.jsx)("span",{className:"px-2.5 py-1 rounded-md text-xs font-semibold uppercase tracking-wide border ".concat(s.color),children:s.label})}},7104(e,t,s){s.d(t,{A:()=>l});const l=(0,s(5228).A)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]])},7719(e,t,s){s.d(t,{A:()=>l});const l=(0,s(5228).A)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},9292(e,t,s){s.d(t,{A:()=>l});const l=(0,s(5228).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},9333(e,t,s){s.d(t,{A:()=>l});const l=(0,s(5228).A)("video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]])}}]);
//# sourceMappingURL=705.086828f6.chunk.js.map