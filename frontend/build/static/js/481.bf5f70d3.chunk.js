/*! For license information please see 481.bf5f70d3.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkrole_based_frontend=self.webpackChunkrole_based_frontend||[]).push([[481],{481(e,s,r){r.r(s),r.d(s,{default:()=>N});var a=r(9379),t=r(5043),l=r(614),i=r(9292),n=r(2024),o=r(2054),c=r(7819),d=r(3639),m=r(1286),u=r(8280),x=r(1360);const p=(0,r(5228).A)("file-exclamation-point",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);var h=r(349),b=r(674),f=r(579);const g=[{id:"electrical",label:"Electrical Issue"},{id:"mechanical",label:"Mechanical Issue"},{id:"software",label:"Software/Firmware"},{id:"cooling",label:"Cooling/Temperature"},{id:"network",label:"Network/Connectivity"},{id:"display",label:"Display/Screen"},{id:"power",label:"Power Supply"},{id:"noise",label:"Noise/Vibration"},{id:"performance",label:"Performance Issue"},{id:"other",label:"Other"}],y=[{value:"low",label:"Low",color:"bg-green-100 text-green-700 border-green-300",description:"Can wait"},{value:"medium",label:"Medium",color:"bg-yellow-100 text-yellow-700 border-yellow-300",description:"Regular"},{value:"high",label:"High",color:"bg-orange-100 text-orange-700 border-orange-300",description:"Urgent"},{value:"critical",label:"Critical",color:"bg-red-100 text-red-700 border-red-300",description:"Emergency"}];function N(e){var s;let{appState:r,user:N,isNewClient:v,isNewMachine:j,setIsNewClient:w,setIsNewMachine:C,onSubmit:A,onClose:k,showToast:D}=e;const[I,S]=(0,t.useState)(!1),[M,P]=(0,t.useState)(""),[z,q]=(0,t.useState)(null),[E,V]=(0,t.useState)(!1),[T,F]=(0,t.useState)(!1),[L,_]=(0,t.useState)({customerId:"",machineId:"",problem:"",priority:"medium",issueCategories:[],customIssue:"",serviceNo:"",isNewCustomer:!1,isNewMachine:!1,customerData:{companyName:"",contactPerson:"",city:"",phone:"",phones:[""],address:"",email:"",serviceNo:""},machineData:{model:"",serialNumber:"",mobileNumbers:[""],installationDate:""}}),[O,U]=(0,t.useState)([]),R=async()=>{if(M.trim()){V(!0),F(!0);try{const e=encodeURIComponent(M.trim()),s=await b.A.get("/customers/search-by-service?serviceNo=".concat(e)),{found:r,customer:t,machines:l}=s.data;r&&t&&void 0!==t.id&&null!==t.id?(q(t),U(l||[]),_(e=>{var s;return(0,a.A)((0,a.A)({},e),{},{customerId:String(t.id),serviceNo:t.serviceNo,isNewCustomer:!1,customerData:{companyName:t.companyName||t.name||t.company||"",contactPerson:t.contactPerson||"",city:t.city||"",phone:t.phone||"",phones:(null===(s=t.phones)||void 0===s?void 0:s.length)>0?t.phones:[t.phone||""],address:t.address||"",email:t.email||"",serviceNo:t.serviceNo||""}})}),w(!1),C(!1),D("Customer found!","success")):(q(null),U([]),_(e=>(0,a.A)((0,a.A)({},e),{},{customerId:"",serviceNo:M.trim(),isNewCustomer:!0,customerData:{serviceNo:M.trim(),companyName:"",contactPerson:"",city:"",phone:"",phones:[""],address:"",email:""}})),w(!0),C(!0),D("New customer - Please fill in details","info"))}catch(t){var e;console.error("Error searching service no:",t);const l=null===(e=r.customers)||void 0===e?void 0:e.find(e=>{var s;return(null===(s=e.serviceNo)||void 0===s?void 0:s.toLowerCase())===M.trim().toLowerCase()});if(l&&void 0!==l.id&&null!==l.id){var s;q(l);const e=(null===(s=r.machines)||void 0===s?void 0:s.filter(e=>e.customerId===l.id))||[];U(e),_(e=>{var s;return(0,a.A)((0,a.A)({},e),{},{customerId:String(l.id),serviceNo:l.serviceNo,isNewCustomer:!1,customerData:{companyName:l.companyName||l.name||"",contactPerson:l.contactPerson||"",city:l.city||"",phone:l.phone||"",phones:(null===(s=l.phones)||void 0===s?void 0:s.length)>0?l.phones:[l.phone||""],address:l.address||"",email:l.email||"",serviceNo:l.serviceNo||""}})}),w(!1),C(!1),D("Customer found!","success")}else q(null),U([]),_(e=>(0,a.A)((0,a.A)({},e),{},{customerId:"",serviceNo:M.trim(),isNewCustomer:!0,customerData:{serviceNo:M.trim(),companyName:"",contactPerson:"",city:"",phone:"",phones:[""],address:"",email:""}})),w(!0),C(!0),D("New customer - Please fill in details","info")}finally{V(!1)}}else D("Please enter a service number","warning")};(0,t.useEffect)(()=>{if(L.customerId&&!v){var e;const s=parseInt(L.customerId),a=(null===(e=r.machines)||void 0===e?void 0:e.filter(e=>e.customerId===s))||[];U(a)}},[L.customerId,r.machines,v]);const H=e=>{const{name:s,value:r}=e.target;_(e=>(0,a.A)((0,a.A)({},e),{},{[s]:"machineId"===s?String(r):r}))},K=e=>{const{name:s,value:r}=e.target;console.log("Updating customerData field: ".concat(s,", Value: ").concat(r)),_(e=>(0,a.A)((0,a.A)({},e),{},{customerData:(0,a.A)((0,a.A)({},e.customerData),{},{[s]:r})}))},B=e=>{const{name:s,value:r}=e.target;_(e=>(0,a.A)((0,a.A)({},e),{},{machineData:(0,a.A)((0,a.A)({},e.machineData),{},{[s]:r})}))};return(0,f.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,f.jsxs)("div",{className:"bg-white rounded-xl max-w-3xl w-full max-h-[95vh] overflow-hidden flex flex-col shadow-2xl",children:[(0,f.jsxs)("div",{className:"bg-gradient-to-r from-primary-600 to-primary-700 text-white px-6 py-4 flex items-center justify-between",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("h2",{className:"text-xl font-semibold tracking-tight",children:"Create Service Ticket"}),(0,f.jsx)("p",{className:"text-primary-100 text-sm mt-0.5",children:"Fill in all required details below"})]}),(0,f.jsx)("button",{onClick:k,className:"p-2 hover:bg-primary-500 rounded-lg transition-colors",disabled:I,title:"Close",children:(0,f.jsx)(l.A,{size:22})})]}),I&&(0,f.jsx)(h.A,{}),!I&&(0,f.jsxs)("div",{className:"flex-1 overflow-y-auto",children:[(0,f.jsxs)("div",{className:"p-6 border-b border-neutral-200 bg-neutral-50",children:[(0,f.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,f.jsx)("div",{className:"w-10 h-10 bg-primary-100 rounded-lg flex items-center justify-center",children:(0,f.jsx)(i.A,{size:20,className:"text-primary-600"})}),(0,f.jsxs)("div",{children:[(0,f.jsx)("h3",{className:"font-semibold text-neutral-900",children:"Step 1: Service Number"}),(0,f.jsx)("p",{className:"text-xs text-neutral-500",children:"Search customer by service number"})]})]}),(0,f.jsxs)("div",{className:"flex gap-3",children:[(0,f.jsxs)("div",{className:"flex-1 relative",children:[(0,f.jsx)("input",{type:"text",value:M,onChange:e=>P(e.target.value),onKeyPress:e=>"Enter"===e.key&&R(),placeholder:"Enter service number (e.g., SVC-001)",className:"w-full px-4 py-2.5 border border-neutral-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-sm",autoFocus:!0}),E&&(0,f.jsx)(n.A,{size:18,className:"absolute right-3 top-1/2 -translate-y-1/2 animate-spin text-primary-600"})]}),(0,f.jsxs)("button",{onClick:R,disabled:!M.trim()||E,className:"px-5 py-2.5 bg-primary-600 text-white rounded-lg font-medium hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2 text-sm",children:[(0,f.jsx)(i.A,{size:16}),"Search"]})]}),T&&z&&(0,f.jsxs)("div",{className:"mt-4 p-3 bg-emerald-50 border border-emerald-200 rounded-lg flex items-center gap-3",children:[(0,f.jsx)(o.A,{size:20,className:"text-emerald-600 flex-shrink-0"}),(0,f.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,f.jsx)("p",{className:"font-medium text-emerald-900 truncate",children:z.companyName||z.name}),(0,f.jsxs)("p",{className:"text-emerald-700 text-xs",children:[z.city," \u2022 ",z.phone]})]})]}),T&&!z&&v&&(0,f.jsxs)("div",{className:"mt-4 p-3 bg-amber-50 border border-amber-200 rounded-lg flex items-center gap-3",children:[(0,f.jsx)(c.A,{size:20,className:"text-amber-600 flex-shrink-0"}),(0,f.jsxs)("div",{children:[(0,f.jsx)("p",{className:"font-medium text-amber-900 text-sm",children:"New Customer"}),(0,f.jsx)("p",{className:"text-amber-700 text-xs",children:"Service number not found. Please fill in customer details below."})]})]})]}),T&&(0,f.jsxs)("div",{className:"p-6 border-b border-neutral-200",children:[(0,f.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,f.jsxs)("div",{className:"flex items-center gap-3",children:[(0,f.jsx)("div",{className:"w-10 h-10 bg-primary-100 rounded-lg flex items-center justify-center",children:(0,f.jsx)(d.A,{size:20,className:"text-primary-600"})}),(0,f.jsxs)("div",{children:[(0,f.jsx)("h3",{className:"font-semibold text-neutral-900",children:"Step 2: Customer Details"}),(0,f.jsx)("p",{className:"text-xs text-neutral-500",children:v?"Enter new customer information":"Customer information"})]})]})}),v?(0,f.jsx)("div",{className:"space-y-4",children:(0,f.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,f.jsxs)("div",{className:"col-span-2 sm:col-span-1",children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"Service No"}),(0,f.jsx)("input",{type:"text",name:"serviceNo",value:L.customerData.serviceNo,onChange:K,className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 bg-neutral-50 text-sm",readOnly:!0})]}),(0,f.jsxs)("div",{className:"col-span-2 sm:col-span-1",children:[(0,f.jsxs)("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["Company Name ",(0,f.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,f.jsx)("input",{type:"text",name:"companyName",value:L.customerData.companyName,onChange:K,placeholder:"Enter company name",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-sm",required:!0})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"Contact Person"}),(0,f.jsx)("input",{type:"text",name:"contactPerson",value:L.customerData.contactPerson,onChange:K,placeholder:"Contact person name",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-sm"})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"City"}),(0,f.jsx)("input",{type:"text",name:"city",value:L.customerData.city,onChange:K,placeholder:"City",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-sm"})]}),(0,f.jsxs)("div",{className:"col-span-2",children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"Address"}),(0,f.jsx)("input",{type:"text",name:"address",value:L.customerData.address,onChange:K,placeholder:"Full address",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-sm"})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"Email"}),(0,f.jsx)("input",{type:"email",name:"email",value:L.customerData.email,onChange:K,placeholder:"email@example.com",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-sm"})]}),(0,f.jsxs)("div",{children:[(0,f.jsxs)("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["Phone ",(0,f.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,f.jsxs)("div",{className:"relative",children:[(0,f.jsx)(m.A,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-neutral-400"}),(0,f.jsx)("input",{type:"tel",value:(Array.isArray(L.customerData.phones)?L.customerData.phones:[""])[0]||"",onChange:e=>{return s=0,r=e.target.value,void _(e=>(0,a.A)((0,a.A)({},e),{},{customerData:(0,a.A)((0,a.A)({},e.customerData),{},{phones:Array.isArray(e.customerData.phones)?e.customerData.phones.map((e,a)=>a===s?r:e):[r]})}));var s,r},placeholder:"Primary phone",className:"w-full pl-10 pr-3 py-2 border border-neutral-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-sm"})]})]})]})}):z&&(0,f.jsx)("div",{className:"p-4 bg-primary-50 border border-primary-200 rounded-lg",children:(0,f.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("span",{className:"text-primary-600 text-xs",children:"Company"}),(0,f.jsx)("p",{className:"font-medium text-primary-900",children:z.companyName||z.name})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("span",{className:"text-primary-600 text-xs",children:"Contact"}),(0,f.jsx)("p",{className:"font-medium text-primary-900",children:z.contactPerson||"-"})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("span",{className:"text-primary-600 text-xs",children:"City"}),(0,f.jsx)("p",{className:"font-medium text-primary-900",children:z.city||"-"})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("span",{className:"text-primary-600 text-xs",children:"Phone"}),(0,f.jsx)("p",{className:"font-medium text-primary-900",children:z.phone||"-"})]}),z.address&&(0,f.jsxs)("div",{className:"col-span-2",children:[(0,f.jsx)("span",{className:"text-primary-600 text-xs",children:"Address"}),(0,f.jsx)("p",{className:"font-medium text-primary-900",children:z.address})]})]})})]}),T&&(0,f.jsxs)("div",{className:"p-6 border-b border-neutral-200",children:[(0,f.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,f.jsxs)("div",{className:"flex items-center gap-3",children:[(0,f.jsx)("div",{className:"w-10 h-10 bg-primary-100 rounded-lg flex items-center justify-center",children:(0,f.jsx)(u.A,{size:20,className:"text-primary-600"})}),(0,f.jsxs)("div",{children:[(0,f.jsx)("h3",{className:"font-semibold text-neutral-900",children:"Step 3: Machine Details"}),(0,f.jsx)("p",{className:"text-xs text-neutral-500",children:j?"Add new machine":"Select or add machine"})]})]}),!v&&O.length>0&&(0,f.jsxs)("button",{type:"button",onClick:()=>C(!j),className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium bg-neutral-800 text-white rounded-md hover:bg-neutral-900 transition-colors",children:[(0,f.jsx)(x.A,{size:14}),j?"Select Existing":"New Machine"]})]}),!v&&!j&&O.length>0&&(0,f.jsxs)("div",{className:"space-y-3",children:[(0,f.jsxs)("select",{name:"machineId",value:L.machineId,onChange:H,className:"w-full px-3 py-2.5 border border-neutral-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-sm",children:[(0,f.jsx)("option",{value:"",children:"Select a machine"}),O.map(e=>(0,f.jsxs)("option",{value:e.id,children:[e.model," - ",e.serialNumber]},e.id))]}),L.machineId&&(0,f.jsx)("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg text-sm",children:(()=>{const e=O.find(e=>e.id===parseInt(L.machineId));return e?(0,f.jsxs)("div",{className:"flex items-center gap-3",children:[(0,f.jsx)(o.A,{size:18,className:"text-green-600"}),(0,f.jsxs)("div",{children:[(0,f.jsx)("p",{className:"font-medium text-green-900",children:e.model}),(0,f.jsxs)("p",{className:"text-green-700 text-xs",children:["Serial: ",e.serialNumber]})]})]}):null})()})]}),!v&&!j&&0===O.length&&(0,f.jsxs)("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-lg text-center",children:[(0,f.jsx)(c.A,{size:24,className:"mx-auto text-amber-600 mb-2"}),(0,f.jsx)("p",{className:"text-amber-800 font-medium text-sm",children:"No machines found for this customer"}),(0,f.jsx)("button",{type:"button",onClick:()=>C(!0),className:"mt-2 px-4 py-1.5 bg-neutral-800 text-white rounded-md hover:bg-neutral-900 font-medium text-sm transition-colors",children:"Add New Machine"})]}),(j||v)&&(0,f.jsx)("div",{className:"space-y-4",children:(0,f.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,f.jsxs)("div",{children:[(0,f.jsxs)("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["Model ",(0,f.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,f.jsx)("input",{type:"text",name:"model",value:L.machineData.model,onChange:B,placeholder:"Machine model",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-sm",required:!0}),(null===(s=r.models)||void 0===s?void 0:s.length)>0&&(0,f.jsx)("div",{className:"mt-2 flex flex-wrap gap-1",children:r.models.slice(0,4).map(e=>(0,f.jsx)("button",{type:"button",onClick:()=>_(s=>(0,a.A)((0,a.A)({},s),{},{machineData:(0,a.A)((0,a.A)({},s.machineData),{},{model:e})})),className:"text-xs px-2 py-1 bg-neutral-100 text-neutral-700 rounded hover:bg-neutral-200 transition-colors",children:e},e))})]}),(0,f.jsxs)("div",{children:[(0,f.jsxs)("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["Serial Number ",(0,f.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,f.jsx)("input",{type:"text",name:"serialNumber",value:L.machineData.serialNumber,onChange:B,placeholder:"Serial number",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-sm",required:!0})]}),(0,f.jsxs)("div",{className:"col-span-2",children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"Machine Contact Number"}),(0,f.jsxs)("div",{className:"relative",children:[(0,f.jsx)(m.A,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-neutral-400"}),(0,f.jsx)("input",{type:"tel",value:L.machineData.mobileNumbers[0]||"",onChange:e=>{return s=0,r=e.target.value,void _(e=>(0,a.A)((0,a.A)({},e),{},{machineData:(0,a.A)((0,a.A)({},e.machineData),{},{mobileNumbers:e.machineData.mobileNumbers.map((e,a)=>a===s?r:e)})}));var s,r},placeholder:"Contact number for this machine",className:"w-full pl-10 pr-3 py-2 border border-neutral-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-sm"})]})]}),(0,f.jsxs)("div",{children:[(0,f.jsxs)("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["Installation Date ",(0,f.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,f.jsx)("input",{type:"date",name:"installationDate",value:L.machineData.installationDate,onChange:B,className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-sm",required:!0})]})]})})]}),T&&(0,f.jsxs)("div",{className:"p-6",children:[(0,f.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,f.jsx)("div",{className:"w-10 h-10 bg-primary-100 rounded-lg flex items-center justify-center",children:(0,f.jsx)(p,{size:20,className:"text-primary-600"})}),(0,f.jsxs)("div",{children:[(0,f.jsx)("h3",{className:"font-semibold text-neutral-900",children:"Step 4: Issue Details"}),(0,f.jsx)("p",{className:"text-xs text-neutral-500",children:"Describe the problem and attach files"})]})]}),(0,f.jsxs)("div",{className:"space-y-5",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Priority Level"}),(0,f.jsx)("div",{className:"grid grid-cols-4 gap-2",children:y.map(e=>(0,f.jsx)("button",{type:"button",onClick:()=>{return s=e.value,void _(e=>(0,a.A)((0,a.A)({},e),{},{priority:s}));var s},className:"p-2 rounded-lg border-2 transition-colors text-center ".concat(L.priority===e.value?e.color+" border-current":"bg-white border-neutral-200 hover:border-neutral-300"),children:(0,f.jsx)("p",{className:"font-semibold text-xs",children:e.label})},e.value))})]}),(0,f.jsxs)("div",{children:[(0,f.jsxs)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:["Issue Type ",(0,f.jsx)("span",{className:"text-neutral-400 font-normal",children:"(select all that apply)"})]}),(0,f.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:g.map(e=>(0,f.jsxs)("label",{className:"flex items-center gap-2 p-2 border rounded-lg cursor-pointer transition-colors text-sm ".concat(L.issueCategories.includes(e.id)?"bg-primary-50 border-primary-300":"border-neutral-200 hover:border-neutral-300 hover:bg-neutral-50"),children:[(0,f.jsx)("input",{type:"checkbox",checked:L.issueCategories.includes(e.id),onChange:()=>{return s=e.id,void _(e=>(0,a.A)((0,a.A)({},e),{},{issueCategories:e.issueCategories.includes(s)?e.issueCategories.filter(e=>e!==s):[...e.issueCategories,s]}));var s},className:"w-4 h-4 rounded border-neutral-300 text-primary-600 focus:ring-primary-500"}),(0,f.jsx)("span",{className:"text-neutral-800 text-xs font-medium",children:e.label})]},e.id))})]}),(0,f.jsxs)("div",{children:[(0,f.jsxs)("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["Problem Description ",(0,f.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,f.jsx)("textarea",{name:"problem",value:L.problem,onChange:H,placeholder:"Describe the issue in detail...",rows:"3",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-sm",required:!0})]}),(0,f.jsxs)("div",{children:[(0,f.jsxs)("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:["Other Issue ",(0,f.jsx)("span",{className:"text-neutral-400 font-normal",children:"(optional)"})]}),(0,f.jsx)("input",{type:"text",name:"customIssue",value:L.customIssue,onChange:H,placeholder:"Any other issue not listed above",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-sm"})]})]})]})]}),!I&&(0,f.jsxs)("div",{className:"px-6 py-4 border-t border-neutral-200 bg-neutral-50 flex items-center gap-3",children:[(0,f.jsx)("div",{className:"flex-1"}),(0,f.jsx)("button",{type:"button",onClick:k,className:"px-5 py-2 border border-neutral-300 text-neutral-700 rounded-md hover:bg-neutral-100 transition-colors text-sm font-medium",children:"Cancel"}),(0,f.jsxs)("button",{type:"button",onClick:async()=>{if(console.log("handleSubmit called"),(()=>{if(v){if(!L.customerData.companyName.trim())return D("Please fill in the required field in Step 2: Customer Details","warning"),!1}else if(!L.customerId||""===L.customerId.trim()||"undefined"===L.customerId)return D("Please select a valid customer in Step 2: Customer Details","warning"),!1;if(j){if(!L.machineData.model.trim())return D("Please fill in the required field in Step 3: Machine Details","warning"),!1;if(!L.machineData.serialNumber.trim())return D("Please fill in the required field in Step 3: Machine Details","warning"),!1;if(!L.machineData.installationDate)return D("Please fill in the required field in Step 3: Machine Details","warning"),!1}else if(!L.machineId||""===L.machineId.trim())return D("Please fill in the required field in Step 3: Machine Details","warning"),!1;return!!L.problem.trim()||(D("Please fill in the required field in Step 4: Issue Details","warning"),!1)})()){console.log("Validation passed, about to call onSubmit with formData:",L),S(!0);try{await A(L),D("Ticket created successfully!","success"),k()}catch(e){console.error("Error creating ticket:",e),D("Failed to create ticket. Please try again.","error")}finally{S(!1)}}else console.log("Validation failed")},disabled:!(()=>{if(console.log("Validating form submission..."),console.log("customerSearched:",T),console.log("isNewClient:",v),console.log("formData.customerId:",L.customerId),console.log("isNewMachine:",j),console.log("formData.machineId:",L.machineId),console.log("formData.problem:",L.problem),console.log("formData.issueCategories:",L.issueCategories),console.log("formData.customIssue:",L.customIssue),!T)return!1;if(v){if(!L.customerData.companyName.trim())return!1}else if(!L.customerId||""===L.customerId.trim()||"undefined"===L.customerId)return!1;if(j){if(!L.machineData.model.trim()||!L.machineData.serialNumber.trim())return!1}else if(!L.machineId||""===L.machineId.trim())return!1;return!!L.problem.trim()&&!(0===L.issueCategories.length&&!L.customIssue.trim())})()||I,className:"px-6 py-2 bg-emerald-600 text-white rounded-md hover:bg-emerald-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm font-medium shadow-sm flex items-center gap-2",children:[(0,f.jsx)(o.A,{size:16}),"Create Ticket"]})]})]})})}},1286(e,s,r){r.d(s,{A:()=>a});const a=(0,r(5228).A)("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]])},2024(e,s,r){r.d(s,{A:()=>a});const a=(0,r(5228).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},8280(e,s,r){r.d(s,{A:()=>a});const a=(0,r(5228).A)("cpu",[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]])},9292(e,s,r){r.d(s,{A:()=>a});const a=(0,r(5228).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])}}]);
//# sourceMappingURL=481.bf5f70d3.chunk.js.map