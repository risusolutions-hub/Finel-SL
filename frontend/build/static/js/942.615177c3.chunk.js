/*! For license information please see 942.615177c3.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkrole_based_frontend=self.webpackChunkrole_based_frontend||[]).push([[942],{942(e,s,t){t.r(s),t.d(s,{default:()=>m});var a=t(5043),l=t(73),c=t(2489),i=t(1064),n=t(1680);const d=(0,t(5228).A)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]);var r=t(7475),o=t(674),x=t(579);function m(e){let{showToast:s}=e;const[t,m]=(0,a.useState)([]),[u,h]=(0,a.useState)([]),[p,y]=(0,a.useState)(!1),[g,f]=(0,a.useState)(!1),[N,j]=(0,a.useState)(""),[b,w]=(0,a.useState)(!1);(0,a.useEffect)(()=>{v()},[]);const v=async()=>{try{const e=await o.A.get("/users?status=blocked");h(e.data.users||[])}catch(e){h([])}},k=[{icon:(0,x.jsx)(l.A,{className:"w-6 h-6 text-red-600"}),title:"Security Scan",description:"Detect suspicious accounts and weak passwords.",action:(0,x.jsxs)("button",{className:"px-4 py-2 bg-red-600 text-white rounded-lg font-medium flex items-center gap-2 disabled:opacity-60",onClick:async()=>{y(!0),null===s||void 0===s||s("Running security scan...","info");try{const e=await o.A.get("/system/security-scan");e.data.success?(m(e.data.suspicious),null===s||void 0===s||s("Scan complete: ".concat(e.data.suspicious.length," suspicious accounts found"),"success")):null===s||void 0===s||s("Scan failed","error")}catch(e){null===s||void 0===s||s("Scan failed","error")}finally{y(!1)}},disabled:p,children:[(0,x.jsx)(c.A,{className:"w-4 h-4"})," ",p?"Scanning...":"Run Scan"]})},{icon:(0,x.jsx)(i.A,{className:"w-6 h-6 text-green-600"}),title:"Unlock Account",description:"Unlock a locked or blocked user account.",action:(0,x.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,x.jsx)("input",{type:"email",value:N,onChange:e=>j(e.target.value),placeholder:"User email to unlock",className:"px-3 py-2 border rounded-lg text-sm",disabled:g}),(0,x.jsxs)("button",{className:"px-4 py-2 bg-green-600 text-white rounded-lg font-medium flex items-center gap-2 disabled:opacity-60",onClick:async()=>{if(!N)return null===s||void 0===s?void 0:s("Enter user email to unlock","warning");f(!0);try{const e=await o.A.post("/system/unlock-account",{email:N});e.data.success?(null===s||void 0===s||s("Account unlocked successfully","success"),v()):null===s||void 0===s||s(e.data.message||"Unlock failed","error")}catch(e){null===s||void 0===s||s("Unlock failed","error")}finally{f(!1),j("")}},disabled:g,children:[(0,x.jsx)(i.A,{className:"w-4 h-4"})," ",g?"Unlocking...":"Unlock"]})]})},{icon:(0,x.jsx)(n.A,{className:"w-6 h-6 text-indigo-600"}),title:"Download Security Report",description:"Download a full security report of all users and actions.",action:(0,x.jsxs)("button",{className:"px-4 py-2 bg-indigo-600 text-white rounded-lg font-medium flex items-center gap-2 disabled:opacity-60",onClick:async()=>{w(!0);try{const e=await o.A.get("/system/security-report",{responseType:"blob"}),t=window.URL.createObjectURL(new Blob([e.data])),a=document.createElement("a");a.href=t,a.download="security_report_".concat((new Date).toISOString().split("T")[0],".csv"),a.click(),null===s||void 0===s||s("Security report downloaded","success")}catch(e){null===s||void 0===s||s("Download failed","error")}finally{w(!1)}},disabled:b,children:[(0,x.jsx)(n.A,{className:"w-4 h-4"})," ",b?"Downloading...":"Download Report"]})},{icon:(0,x.jsx)(d,{className:"w-6 h-6 text-blue-600"}),title:"Security Alerts",description:"Email notifications for suspicious activity (coming soon).",action:(0,x.jsxs)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg font-medium flex items-center gap-2",disabled:!0,children:[(0,x.jsx)(d,{className:"w-4 h-4"})," Configure Alerts"]})}];return(0,x.jsxs)("div",{className:"p-6 space-y-8",children:[(0,x.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,x.jsx)(c.A,{className:"w-5 h-5 text-red-500"}),(0,x.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"Security Panel"}),(0,x.jsx)("span",{className:"ml-2 px-3 py-1 rounded-full bg-red-100 text-red-700 text-xs font-semibold",children:"Super Admin"})]}),(0,x.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:k.map((e,s)=>(0,x.jsxs)("div",{className:"bg-white border rounded-xl p-6 flex flex-col gap-3 shadow-sm",children:[(0,x.jsx)("div",{children:e.icon}),(0,x.jsx)("h3",{className:"font-semibold text-gray-900",children:e.title}),(0,x.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:e.description}),(0,x.jsx)("div",{children:e.action})]},s))}),(0,x.jsxs)("div",{className:"mt-10",children:[(0,x.jsxs)("h2",{className:"font-semibold text-lg text-gray-900 mb-3 flex items-center gap-2",children:[(0,x.jsx)(r.A,{className:"w-5 h-5 text-red-600"})," Blocked Accounts"]}),(0,x.jsx)("div",{className:"bg-white border rounded-xl overflow-x-auto",children:(0,x.jsxs)("table",{className:"w-full text-sm",children:[(0,x.jsx)("thead",{className:"bg-gray-50 border-b",children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{className:"px-4 py-3 text-left font-medium text-gray-600",children:"Name"}),(0,x.jsx)("th",{className:"px-4 py-3 text-left font-medium text-gray-600",children:"Email"}),(0,x.jsx)("th",{className:"px-4 py-3 text-left font-medium text-gray-600",children:"Role"}),(0,x.jsx)("th",{className:"px-4 py-3 text-left font-medium text-gray-600",children:"Status"})]})}),(0,x.jsxs)("tbody",{className:"divide-y",children:[u.map(e=>(0,x.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,x.jsx)("td",{className:"px-4 py-3",children:e.name}),(0,x.jsx)("td",{className:"px-4 py-3",children:e.email}),(0,x.jsx)("td",{className:"px-4 py-3 capitalize",children:e.role}),(0,x.jsx)("td",{className:"px-4 py-3 capitalize text-red-600 font-semibold",children:e.status})]},e._id||e.id)),0===u.length&&(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:4,className:"px-4 py-8 text-center text-gray-500",children:"No blocked accounts"})})]})]})})]}),t.length>0&&(0,x.jsxs)("div",{className:"mt-10",children:[(0,x.jsxs)("h2",{className:"font-semibold text-lg text-gray-900 mb-3 flex items-center gap-2",children:[(0,x.jsx)(c.A,{className:"w-5 h-5 text-red-600"})," Suspicious Accounts"]}),(0,x.jsx)("div",{className:"bg-white border rounded-xl overflow-x-auto",children:(0,x.jsxs)("table",{className:"w-full text-sm",children:[(0,x.jsx)("thead",{className:"bg-gray-50 border-b",children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{className:"px-4 py-2 text-left font-medium text-gray-600",children:"Reason"}),(0,x.jsx)("th",{className:"px-4 py-2 text-left font-medium text-gray-600",children:"Name"}),(0,x.jsx)("th",{className:"px-4 py-2 text-left font-medium text-gray-600",children:"Email"}),(0,x.jsx)("th",{className:"px-4 py-2 text-left font-medium text-gray-600",children:"Role"}),(0,x.jsx)("th",{className:"px-4 py-2 text-left font-medium text-gray-600",children:"Status"})]})}),(0,x.jsx)("tbody",{className:"divide-y",children:t.map((e,s)=>{var t,a,l,c;return(0,x.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,x.jsx)("td",{className:"px-4 py-2 text-xs text-red-600 font-semibold",children:e.reason}),(0,x.jsx)("td",{className:"px-4 py-2",children:(null===(t=e.user)||void 0===t?void 0:t.name)||"N/A"}),(0,x.jsx)("td",{className:"px-4 py-2",children:(null===(a=e.user)||void 0===a?void 0:a.email)||"N/A"}),(0,x.jsx)("td",{className:"px-4 py-2 capitalize",children:(null===(l=e.user)||void 0===l?void 0:l.role)||"N/A"}),(0,x.jsx)("td",{className:"px-4 py-2 capitalize",children:(null===(c=e.user)||void 0===c?void 0:c.status)||"N/A"})]},s)})})]})})]})]})}},1064(e,s,t){t.d(s,{A:()=>a});const a=(0,t(5228).A)("lock-open",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]])},7475(e,s,t){t.d(s,{A:()=>a});const a=(0,t(5228).A)("ban",[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])}}]);
//# sourceMappingURL=942.615177c3.chunk.js.map