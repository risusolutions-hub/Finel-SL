"use strict";(self.webpackChunkrole_based_frontend=self.webpackChunkrole_based_frontend||[]).push([[10],{4010(e,t,s){s.r(t),s.d(t,{default:()=>x});var a=s(9379),l=s(5043),i=s(6567),r=s(1360),d=s(7365),o=s(9855),n=s(349),c=s(579);function x(e){var t,s;let{userRole:x}=e;const[u,h]=(0,l.useState)([]),[g,m]=(0,l.useState)(null),[p,b]=(0,l.useState)(!1),[y,f]=(0,l.useState)(""),[j,N]=(0,l.useState)(!0),[v,w]=(0,l.useState)({});(0,l.useEffect)(()=>{k(),C()},[]);const k=async()=>{try{N(!0);const s=await fetch("/api/dashboard/layouts",{credentials:"include"}),a=await s.json();if(a.success){var e,t;h(a.layouts||[]);const s=null===(e=a.layouts)||void 0===e?void 0:e.find(e=>e.isDefault);m(s||(null===(t=a.layouts)||void 0===t?void 0:t[0]))}}catch(s){console.error("Error loading layouts:",s)}finally{N(!1)}},C=async()=>{try{const e=await fetch("/api/dashboard/templates",{credentials:"include"}),t=await e.json();t.success&&w(t.templates||{})}catch(e){console.error("Error loading templates:",e)}};return j?(0,c.jsx)(n.A,{}):(0,c.jsxs)("div",{className:"space-y-6",children:[(0,c.jsx)("div",{className:"flex items-center justify-between pb-4 border-b border-slate-200",children:(0,c.jsxs)("div",{children:[(0,c.jsxs)("h2",{className:"text-xl font-bold text-slate-900 flex items-center gap-2",children:[(0,c.jsx)(i.A,{size:24,className:"text-blue-600"}),"Dashboard Customization"]}),(0,c.jsx)("p",{className:"text-sm text-slate-500",children:"Create and manage personalized dashboard layouts"})]})}),(0,c.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[u.map(e=>(0,c.jsxs)("button",{onClick:()=>m(e),className:"px-4 py-2 rounded-lg font-medium transition relative ".concat((null===g||void 0===g?void 0:g.id)===e.id?"bg-blue-600 text-white":"bg-slate-100 text-slate-700 hover:bg-slate-200"),children:[e.layoutName,e.isDefault&&(0,c.jsx)("span",{className:"ml-2 text-xs bg-amber-500 px-2 py-1 rounded-full",children:"Default"})]},e.id)),(0,c.jsxs)("button",{onClick:()=>b(!p),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition flex items-center gap-2",children:[(0,c.jsx)(r.A,{size:16})," New Layout"]})]}),p&&(0,c.jsx)("div",{className:"bg-slate-50 border border-slate-200 rounded-lg p-4",children:(0,c.jsxs)("div",{className:"space-y-3",children:[(0,c.jsx)("input",{type:"text",placeholder:"Layout name (e.g., Daily Engineer View)",value:y,onChange:e=>f(e.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"}),(0,c.jsxs)("div",{className:"flex gap-2",children:[(0,c.jsx)("button",{onClick:async()=>{if(y.trim())try{const e=v[x]||[],t=await fetch("/api/dashboard/layouts",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({layoutName:y,widgets:e,isDefault:0===u.length})});if(t.ok){const e=await t.json();h([...u,e.layout]),m(e.layout),f(""),b(!1)}}catch(e){console.error("Error creating layout:",e)}},className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition",children:"Create Layout"}),(0,c.jsx)("button",{onClick:()=>b(!1),className:"flex-1 px-4 py-2 bg-slate-300 text-slate-700 rounded-lg hover:bg-slate-400 transition",children:"Cancel"})]})]})}),g&&(0,c.jsxs)("div",{className:"space-y-4",children:[(0,c.jsxs)("div",{className:"flex items-center justify-between bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("h3",{className:"font-bold text-slate-900",children:g.layoutName}),(0,c.jsxs)("p",{className:"text-sm text-slate-600",children:[(null===(t=g.widgets)||void 0===t?void 0:t.length)||0," widgets"]})]}),(0,c.jsxs)("div",{className:"flex gap-2",children:[(0,c.jsx)("button",{onClick:()=>(async e=>{try{const t=await fetch("/api/dashboard/layouts/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({isDefault:!0})});if(t.ok){const s=await t.json();h(u.map(t=>(0,a.A)((0,a.A)({},t),{},{isDefault:t.id===e}))),m(s.layout)}}catch(t){console.error("Error setting default:",t)}})(g.id),disabled:g.isDefault,className:"px-3 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 disabled:opacity-50 transition text-sm",children:g.isDefault?"Default":"Set as Default"}),(0,c.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Delete this layout?"))try{if((await fetch("/api/dashboard/layouts/".concat(e),{method:"DELETE",credentials:"include"})).ok){const t=u.filter(t=>t.id!==e);h(t),m(t[0]||null)}}catch(t){console.error("Error deleting layout:",t)}})(g.id),className:"px-3 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition",children:(0,c.jsx)(o.A,{size:16})})]})]}),g.widgets&&g.widgets.length>0?(0,c.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:g.widgets.map(e=>(0,c.jsxs)("div",{className:"bg-white border border-slate-200 rounded-lg p-4 relative group hover:shadow-lg transition",children:[(0,c.jsx)("button",{onClick:()=>(async(e,t)=>{try{const s=await fetch("/api/dashboard/layouts/".concat(e,"/widgets/").concat(t),{method:"DELETE",credentials:"include"});if(s.ok){const t=await s.json();m(t.layout),h(u.map(s=>s.id===e?t.layout:s))}}catch(s){console.error("Error removing widget:",s)}})(g.id,e.id),className:"absolute top-2 right-2 p-2 bg-red-100 text-red-600 rounded opacity-0 group-hover:opacity-100 transition",children:(0,c.jsx)(o.A,{size:14})}),(0,c.jsxs)("div",{className:"flex items-start gap-3",children:[(0,c.jsx)(d.A,{size:20,className:"text-blue-600 flex-shrink-0"}),(0,c.jsxs)("div",{className:"flex-1",children:[(0,c.jsx)("h4",{className:"font-bold text-slate-900",children:e.title}),(0,c.jsx)("p",{className:"text-sm text-slate-600 mt-1 capitalize",children:e.type}),(0,c.jsx)("div",{className:"mt-2 text-xs text-slate-500",children:(0,c.jsxs)("p",{children:["Size: ",e.size.width,"x",e.size.height]})})]})]}),(0,c.jsxs)("div",{className:"mt-3 pt-3 border-t border-slate-200 space-y-2",children:[(0,c.jsx)("label",{className:"block text-xs font-bold text-slate-600",children:"Filters"}),Object.keys(e.filters).length>0?(0,c.jsx)("div",{className:"text-xs text-slate-600",children:Object.entries(e.filters).map(e=>{let[t,s]=e;return(0,c.jsxs)("p",{children:[t,": ",String(s)]},t)})}):(0,c.jsx)("p",{className:"text-xs text-slate-500",children:"No filters configured"})]})]},e.id))}):(0,c.jsxs)("div",{className:"text-center py-8 bg-slate-50 border-2 border-dashed border-slate-300 rounded-lg",children:[(0,c.jsx)("p",{className:"text-slate-500",children:"No widgets in this layout yet"}),(0,c.jsx)("p",{className:"text-sm text-slate-400 mt-1",children:"Create a new layout to start with templates"})]})]}),Object.keys(v).length>0&&(0,c.jsxs)("div",{className:"pt-6 border-t border-slate-200",children:[(0,c.jsx)("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"Available Widget Templates"}),(0,c.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:(null===(s=v[x])||void 0===s?void 0:s.map(e=>(0,c.jsxs)("div",{className:"bg-slate-50 border border-slate-200 rounded-lg p-3",children:[(0,c.jsx)("p",{className:"font-bold text-slate-900 text-sm",children:e.title}),(0,c.jsx)("p",{className:"text-xs text-slate-600 mt-1 capitalize",children:e.type})]},e.id)))||[]})]})]})}}}]);
//# sourceMappingURL=10.62255e4c.chunk.js.map