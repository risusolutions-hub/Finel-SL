{"version":3,"file":"static/js/130.68a136c0.chunk.js","mappings":"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","sources":["../node_modules/lucide-react/src/icons/link-2.ts","../node_modules/lucide-react/src/icons/copy.ts","components/dashboard/DuplicateDetection.js"],"sourcesContent":["import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M9 17H7A5 5 0 0 1 7 7h2', key: '8i5ue5' }],\n  ['path', { d: 'M15 7h2a5 5 0 1 1 0 10h-2', key: '1b9ql8' }],\n  ['line', { x1: '8', x2: '16', y1: '12', y2: '12', key: '1jonct' }],\n];\n\n/**\n * @component @name Link2\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNOSAxN0g3QTUgNSAwIDAgMSA3IDdoMiIgLz4KICA8cGF0aCBkPSJNMTUgN2gyYTUgNSAwIDEgMSAwIDEwaC0yIiAvPgogIDxsaW5lIHgxPSI4IiB4Mj0iMTYiIHkxPSIxMiIgeTI9IjEyIiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/link-2\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Link2 = createLucideIcon('link-2', __iconNode);\n\nexport default Link2;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['rect', { width: '14', height: '14', x: '8', y: '8', rx: '2', ry: '2', key: '17jyea' }],\n  ['path', { d: 'M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2', key: 'zix9uf' }],\n];\n\n/**\n * @component @name Copy\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cmVjdCB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIHg9IjgiIHk9IjgiIHJ4PSIyIiByeT0iMiIgLz4KICA8cGF0aCBkPSJNNCAxNmMtMS4xIDAtMi0uOS0yLTJWNGMwLTEuMS45LTIgMi0yaDEwYzEuMSAwIDIgLjkgMiAyIiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/copy\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Copy = createLucideIcon('copy', __iconNode);\n\nexport default Copy;\n","import React, { useState, useEffect } from 'react';\r\nimport { AlertTriangle, Link2, Copy, Trash2 } from 'lucide-react';\r\nimport Loader from '../Loader';\r\n\r\nexport default function DuplicateDetection({ complaintId, customerId, description, title }) {\r\n  const [potentialDuplicates, setPotentialDuplicates] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [hasDuplicates, setHasDuplicates] = useState(false);\r\n  const [linkedDuplicates, setLinkedDuplicates] = useState([]);\r\n\r\n  useEffect(() => {\r\n    if (complaintId) {\r\n      loadLinkedDuplicates();\r\n    }\r\n  }, [complaintId]);\r\n\r\n  const detectDuplicates = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const response = await fetch('/api/duplicates/detect', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        credentials: 'include',\r\n        body: JSON.stringify({ customerId, description, title })\r\n      });\r\n\r\n      const data = await response.json();\r\n      if (data.success) {\r\n        setPotentialDuplicates(data.potentialDuplicates || []);\r\n        setHasDuplicates(data.hasDuplicates);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error detecting duplicates:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const loadLinkedDuplicates = async () => {\r\n    try {\r\n      const response = await fetch(`/api/duplicates/complaints/${complaintId}`, {\r\n        credentials: 'include'\r\n      });\r\n\r\n      const data = await response.json();\r\n      if (data.success) {\r\n        setLinkedDuplicates(data.duplicates || []);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading duplicates:', error);\r\n    }\r\n  };\r\n\r\n  const handleLinkDuplicate = async (duplicateId) => {\r\n    try {\r\n      const response = await fetch('/api/duplicates/link', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        credentials: 'include',\r\n        body: JSON.stringify({\r\n          primaryComplaintId: complaintId,\r\n          duplicateComplaintId: duplicateId,\r\n          linkReason: 'Auto-detected similar complaint'\r\n        })\r\n      });\r\n\r\n      if (response.ok) {\r\n        setPotentialDuplicates(potentialDuplicates.filter(d => d.id !== duplicateId));\r\n        loadLinkedDuplicates();\r\n      }\r\n    } catch (error) {\r\n      console.error('Error linking duplicate:', error);\r\n    }\r\n  };\r\n\r\n  const handleUnlinkDuplicate = async (linkId) => {\r\n    try {\r\n      const response = await fetch(`/api/duplicates/link/${linkId}`, {\r\n        method: 'DELETE',\r\n        credentials: 'include'\r\n      });\r\n\r\n      if (response.ok) {\r\n        loadLinkedDuplicates();\r\n      }\r\n    } catch (error) {\r\n      console.error('Error unlinking duplicate:', error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      {/* Linked Duplicates */}\r\n      {linkedDuplicates.length > 0 && (\r\n        <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\r\n          <h3 className=\"font-bold text-blue-900 mb-3 flex items-center gap-2\">\r\n            <Link2 size={18} />\r\n            Linked Duplicates ({linkedDuplicates.length})\r\n          </h3>\r\n          <div className=\"space-y-2\">\r\n            {linkedDuplicates.map(link => (\r\n              <div key={link.id} className=\"bg-white rounded p-3 flex items-start justify-between\">\r\n                <div className=\"flex-1\">\r\n                  <p className=\"font-medium text-slate-900\">\r\n                    Complaint #{link.duplicateComplaintId}\r\n                  </p>\r\n                  {link.linkReason && (\r\n                    <p className=\"text-sm text-slate-600\">{link.linkReason}</p>\r\n                  )}\r\n                </div>\r\n                <button\r\n                  onClick={() => handleUnlinkDuplicate(link.id)}\r\n                  className=\"p-2 text-red-600 hover:bg-red-50 rounded transition\"\r\n                >\r\n                  <Trash2 size={16} />\r\n                </button>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Duplicate Detection */}\r\n      <div className=\"bg-white border border-slate-200 rounded-lg p-4\">\r\n        <button\r\n          onClick={detectDuplicates}\r\n          disabled={loading}\r\n          className=\"w-full px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 disabled:opacity-50 transition flex items-center justify-center gap-2\"\r\n        >\r\n          <AlertTriangle size={18} />\r\n          {loading ? 'Checking...' : 'Check for Similar Complaints'}\r\n        </button>\r\n      </div>\r\n\r\n      {potentialDuplicates.length > 0 && (\r\n        <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-4\">\r\n          <h3 className=\"font-bold text-yellow-900 mb-3 flex items-center gap-2\">\r\n            <AlertTriangle size={18} />\r\n            Potential Duplicates Found ({potentialDuplicates.length})\r\n          </h3>\r\n          <div className=\"space-y-2\">\r\n            {potentialDuplicates.map(complaint => (\r\n              <div key={complaint.id} className=\"bg-white rounded p-3 flex items-start justify-between\">\r\n                <div className=\"flex-1\">\r\n                  <p className=\"font-medium text-slate-900\">\r\n                    Complaint #{complaint.id}: {complaint.title}\r\n                  </p>\r\n                  <p className=\"text-sm text-slate-600 mt-1\">{complaint.description}</p>\r\n                  <div className=\"flex items-center gap-2 mt-2\">\r\n                    <span className=\"text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded\">\r\n                      Status: {complaint.status}\r\n                    </span>\r\n                    <span className=\"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded\">\r\n                      {complaint.similarityScore}% match\r\n                    </span>\r\n                  </div>\r\n                </div>\r\n                <button\r\n                  onClick={() => handleLinkDuplicate(complaint.id)}\r\n                  className=\"px-3 py-2 bg-orange-600 text-white rounded hover:bg-orange-700 transition flex items-center gap-1 whitespace-nowrap ml-2\"\r\n                >\r\n                  <Copy size={14} /> Link\r\n                </button>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {hasDuplicates === false && potentialDuplicates.length === 0 && !loading && (\r\n        <div className=\"bg-green-50 border border-green-200 rounded-lg p-4 text-center\">\r\n          <p className=\"text-green-700 font-medium\">No similar complaints found</p>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":["Link2","createLucideIcon","d","key","x1","x2","y1","y2","Copy","width","height","x","y","rx","ry","DuplicateDetection","_ref","complaintId","customerId","description","title","potentialDuplicates","setPotentialDuplicates","useState","loading","setLoading","hasDuplicates","setHasDuplicates","linkedDuplicates","setLinkedDuplicates","useEffect","loadLinkedDuplicates","async","response","fetch","concat","credentials","data","json","success","duplicates","error","console","_jsxs","className","children","length","_jsx","size","map","link","duplicateComplaintId","linkReason","onClick","linkId","method","ok","handleUnlinkDuplicate","id","Trash2","headers","body","JSON","stringify","disabled","AlertTriangle","complaint","status","similarityScore","primaryComplaintId","duplicateId","filter","handleLinkDuplicate"],"ignoreList":[],"sourceRoot":""}