/*! For license information please see 980.8a9a8087.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkrole_based_frontend=self.webpackChunkrole_based_frontend||[]).push([[980],{1286(e,s,a){a.d(s,{A:()=>t});const t=(0,a(5228).A)("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]])},1980(e,s,a){a.r(s),a.d(s,{default:()=>w});var t=a(5043),l=a(5244),r=a(5228);const d=(0,r.A)("building",[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]]),c=(0,r.A)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);var n=a(8646);const i=(0,r.A)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),o=(0,r.A)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]);var x=a(7475),m=a(2054);const p=(0,r.A)("pause",[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]]);var h=a(6245),b=a(5087),g=a(4459),u=a(1286);const j=(0,r.A)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);var N=a(6401);const y=(0,r.A)("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]]);var f=a(5088),v=a(6327),k=a(579);function w(e){let{complaints:s,customers:a,machines:r,currentUser:w,onTakeTicket:A,onStartWork:M,onComplete:C,onClose:_,onCancelAssignment:T,onViewDetails:I}=e;const[z,D]=(0,t.useState)(null),[S,q]=(0,t.useState)("my"),E=s.filter(e=>parseInt(e.assignedTo)===parseInt(null===w||void 0===w?void 0:w.id)&&["assigned","in_progress"].includes(e.status)),V=s.filter(e=>"pending"===e.status&&!e.assignedTo),P=s.filter(e=>["resolved","closed"].includes(e.status)),H="my"===S?E:"available"===S?V:P,W=e=>{switch(e){case"critical":return"bg-red-50 text-red-700 border-red-200";case"high":return"bg-orange-50 text-orange-700 border-orange-200";case"medium":return"bg-amber-50 text-amber-700 border-amber-200";case"low":return"bg-emerald-50 text-emerald-700 border-emerald-200";default:return"bg-slate-50 text-slate-700 border-slate-200"}},L=e=>{switch(e){case"pending":return"border-l-blue-500";case"assigned":return"border-l-purple-500";case"in_progress":return"border-l-amber-500";case"resolved":return"border-l-emerald-500";case"closed":return"border-l-slate-500";default:return"border-l-slate-300"}},R=e=>e?new Date(e).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-";return(0,k.jsxs)("div",{className:"space-y-6",children:[(0,k.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 border-b border-slate-200 pb-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("h1",{className:"text-xl font-bold text-slate-900",children:"My Tickets"}),(0,k.jsx)("p",{className:"text-sm text-slate-500",children:"Manage your assigned service tickets"})]}),(0,k.jsxs)("div",{className:"flex gap-3",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-blue-50 border border-blue-100 rounded-md",children:[(0,k.jsx)("span",{className:"text-xs font-medium text-blue-700",children:"My Tickets"}),(0,k.jsx)("span",{className:"text-sm font-bold text-blue-900",children:E.length})]}),(0,k.jsxs)("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-emerald-50 border border-emerald-100 rounded-md",children:[(0,k.jsx)("span",{className:"text-xs font-medium text-emerald-700",children:"Available"}),(0,k.jsx)("span",{className:"text-sm font-bold text-emerald-900",children:V.length})]})]})]}),(0,k.jsx)("div",{className:"flex gap-2",children:[{id:"my",label:"My Tickets",count:E.length},{id:"available",label:"Available",count:V.length},{id:"history",label:"Closed",count:P.length}].map(e=>(0,k.jsxs)("button",{onClick:()=>q(e.id),className:"px-4 py-2 text-sm font-medium rounded-md border transition-all ".concat(S===e.id?"bg-slate-900 text-white border-slate-900 shadow-sm":"bg-white text-slate-600 border-slate-200 hover:bg-slate-50 hover:border-slate-300"),children:[e.label," ",(0,k.jsxs)("span",{className:"ml-1 opacity-75",children:["(",e.count,")"]})]},e.id))}),0===H.length?(0,k.jsxs)("div",{className:"text-center py-16 bg-white border border-slate-200 rounded-lg border-dashed",children:[(0,k.jsx)(l.A,{className:"w-10 h-10 text-slate-300 mx-auto mb-3"}),(0,k.jsx)("p",{className:"text-slate-500 font-medium",children:"my"===S?"No active tickets assigned to you":"available"===S?"No open tickets available":"No completed or closed tickets"})]}):(0,k.jsx)("div",{className:"space-y-4",children:H.map((e,s)=>{var t;const l=e=>e&&String(e).trim()&&"undefined"!==String(e)?String(e):null,I=(S=l(e.customerId),a.find(e=>e.id===S));var S;const q=(E=l(e.machineId),r.find(e=>e.id===E));var E;const V=l(e.id)||l(e._id)||l(e.complaintId)||"ticket-".concat(s);try{console.debug("EngineerTicketsView key:",{idx:s,id:l(e.id),_id:l(e._id),complaintId:l(e.complaintId),finalKey:V})}catch(K){}const P=l(e._id)||l(e.id)||l(e.complaintId)||"ticket-".concat(s),H=z===V,U=e.assignedTo&&(null===w||void 0===w?void 0:w.id)&&String(l(e.assignedTo))===String(l(w.id));return(0,k.jsxs)("div",{className:"bg-white rounded-lg border border-slate-200 shadow-sm hover:border-slate-300 border-l-4 ".concat(L(e.status)," transition-all"),children:[(0,k.jsx)("div",{className:"p-4 sm:px-6 sm:py-5",children:(0,k.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-start justify-between gap-4",children:[(0,k.jsx)("div",{className:"flex-1 space-y-3",children:(0,k.jsxs)("div",{className:"flex items-start gap-4",children:[(0,k.jsx)("div",{className:"mt-1",children:(0,k.jsxs)("span",{className:"text-xs font-mono font-bold text-slate-500 block",children:["#",e.displayId||e.complaintId||(l(e.id)?"#".concat(l(e.id)):"#".concat(s))]})}),(0,k.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2 flex-wrap mb-1",children:[(0,k.jsx)(v.A,{status:e.status}),(0,k.jsx)("span",{className:"px-2 py-0.5 text-[10px] uppercase font-bold tracking-wide rounded border ".concat(W(e.priority)),children:null===(t=e.priority)||void 0===t?void 0:t.toUpperCase()})]}),(0,k.jsx)("p",{className:"text-slate-900 font-medium text-base truncate",children:e.problem}),(0,k.jsxs)("div",{className:"flex flex-wrap items-center gap-x-6 gap-y-2 mt-2 text-sm text-slate-500",children:[I&&(0,k.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,k.jsx)(d,{className:"w-3.5 h-3.5"}),(0,k.jsx)("span",{children:I.companyName})]}),q&&(0,k.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,k.jsx)(c,{className:"w-3.5 h-3.5"}),(0,k.jsx)("span",{children:q.model})]}),(0,k.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,k.jsx)(n.A,{className:"w-3.5 h-3.5"}),(0,k.jsx)("span",{children:R(e.createdAt)})]})]})]})]})}),(0,k.jsxs)("div",{className:"flex items-center gap-2 flex-wrap sm:flex-nowrap justify-end",children:["pending"===e.status&&!e.assignedTo&&(0,k.jsxs)("button",{onClick:()=>A&&A(P),className:"flex items-center gap-1.5 px-3 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors text-xs font-bold uppercase tracking-wide",children:[(0,k.jsx)(i,{className:"w-3.5 h-3.5"}),"Take Ticket"]}),"assigned"===e.status&&U&&(0,k.jsxs)("button",{onClick:()=>M&&M(P,"in_progress"),className:"flex items-center gap-1.5 px-3 py-2 bg-amber-500 text-white rounded-md hover:bg-amber-600 transition-colors text-xs font-bold uppercase tracking-wide",children:[(0,k.jsx)(o,{className:"w-3.5 h-3.5"}),"Start Work"]}),"assigned"===e.status&&U&&(0,k.jsxs)("button",{onClick:()=>T&&T(P),className:"flex items-center gap-1.5 px-3 py-2 border border-red-200 text-red-700 hover:bg-red-50 rounded-md transition-colors text-xs font-bold uppercase tracking-wide",children:[(0,k.jsx)(x.A,{className:"w-3.5 h-3.5"}),"Cancel"]}),"in_progress"===e.status&&U&&(0,k.jsxs)("button",{onClick:()=>C&&C(e),className:"flex items-center gap-1.5 px-3 py-2 bg-emerald-600 text-white rounded-md hover:bg-emerald-700 transition-colors text-xs font-bold uppercase tracking-wide",children:[(0,k.jsx)(m.A,{className:"w-3.5 h-3.5"}),"Complete"]}),"in_progress"===e.status&&U&&(0,k.jsxs)("button",{onClick:()=>T&&T(P),className:"flex items-center gap-1.5 px-3 py-2 border border-amber-200 text-amber-700 hover:bg-amber-50 rounded-md transition-colors text-xs font-bold uppercase tracking-wide",children:[(0,k.jsx)(p,{className:"w-3.5 h-3.5"}),"Pause"]}),"in_progress"===e.status&&U&&(0,k.jsxs)("button",{onClick:()=>_&&_(e),className:"flex items-center gap-1.5 px-3 py-2 bg-slate-600 text-white rounded-md hover:bg-slate-700 transition-colors text-xs font-bold uppercase tracking-wide",children:[(0,k.jsx)(h.A,{className:"w-3.5 h-3.5"}),"Close"]}),(0,k.jsxs)("button",{onClick:()=>{var e;D(z===(e=V)?null:e)},className:"flex items-center gap-1 px-3 py-2 border border-slate-200 text-slate-600 rounded-md hover:bg-slate-50 transition-colors text-xs font-bold uppercase tracking-wide",children:[(0,k.jsx)(b.A,{className:"w-3.5 h-3.5"}),H?"Hide":"Details"]})]})]})}),H&&(0,k.jsx)("div",{className:"border-t border-slate-200 bg-slate-50/50 p-6",children:(0,k.jsxs)("div",{className:"grid md:grid-cols-2 gap-8",children:[I&&(0,k.jsxs)("div",{className:"space-y-3",children:[(0,k.jsxs)("h4",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider flex items-center gap-2",children:[(0,k.jsx)(g.A,{className:"w-3.5 h-3.5"}),"Customer Information"]}),(0,k.jsxs)("div",{className:"bg-white p-4 rounded-md border border-slate-200 space-y-3 text-sm",children:[(0,k.jsxs)("div",{className:"grid grid-cols-[80px_1fr] gap-2",children:[(0,k.jsx)("span",{className:"text-slate-500",children:"Company:"}),(0,k.jsx)("span",{className:"font-medium text-slate-900",children:I.companyName})]}),(0,k.jsxs)("div",{className:"grid grid-cols-[80px_1fr] gap-2",children:[(0,k.jsx)("span",{className:"text-slate-500",children:"Contact:"}),(0,k.jsx)("span",{className:"font-medium text-slate-900",children:I.contactPerson})]}),(0,k.jsxs)("div",{className:"grid grid-cols-[80px_1fr] gap-2 items-center",children:[(0,k.jsx)("span",{className:"text-slate-500",children:"Phone:"}),(0,k.jsxs)("a",{href:"tel:".concat(I.phone),className:"font-medium text-blue-600 hover:underline flex items-center gap-1",children:[(0,k.jsx)(u.A,{className:"w-3 h-3"}),I.phone]})]}),(0,k.jsxs)("div",{className:"grid grid-cols-[80px_1fr] gap-2",children:[(0,k.jsx)("span",{className:"text-slate-500",children:"Location:"}),(0,k.jsxs)("span",{className:"font-medium text-slate-900 flex items-center gap-1",children:[(0,k.jsx)(j,{className:"w-3 h-3 text-slate-400"}),I.city]})]}),I.address&&(0,k.jsxs)("div",{className:"pt-2 mt-2 border-t border-slate-100",children:[(0,k.jsx)("span",{className:"text-slate-500 block mb-1 text-xs",children:"Address:"}),(0,k.jsx)("span",{className:"text-slate-700",children:I.address})]})]})]}),q&&(0,k.jsxs)("div",{className:"space-y-3",children:[(0,k.jsxs)("h4",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider flex items-center gap-2",children:[(0,k.jsx)(N.A,{className:"w-3.5 h-3.5"}),"Machine Information"]}),(0,k.jsxs)("div",{className:"bg-white p-4 rounded-md border border-slate-200 space-y-3 text-sm",children:[(0,k.jsxs)("div",{className:"grid grid-cols-[100px_1fr] gap-2",children:[(0,k.jsx)("span",{className:"text-slate-500",children:"Model:"}),(0,k.jsx)("span",{className:"font-medium text-slate-900",children:q.model})]}),(0,k.jsxs)("div",{className:"grid grid-cols-[100px_1fr] gap-2",children:[(0,k.jsx)("span",{className:"text-slate-500",children:"Serial No:"}),(0,k.jsx)("span",{className:"font-mono text-slate-700 bg-slate-100 px-2 py-0.5 rounded text-xs",children:q.serialNumber})]}),(0,k.jsxs)("div",{className:"grid grid-cols-[100px_1fr] gap-2",children:[(0,k.jsx)("span",{className:"text-slate-500",children:"Install Date:"}),(0,k.jsx)("span",{className:"font-medium text-slate-900",children:R(q.installDate)})]}),(0,k.jsxs)("div",{className:"grid grid-cols-[100px_1fr] gap-2",children:[(0,k.jsx)("span",{className:"text-slate-500",children:"Warranty:"}),(0,k.jsxs)("span",{className:"font-medium ".concat(new Date(q.warrantyEnd)>new Date?"text-emerald-700":"text-red-700"),children:[new Date(q.warrantyEnd)>new Date?"Active":"Expired",(0,k.jsxs)("span",{className:"text-slate-400 ml-1 text-xs",children:["(",R(q.warrantyEnd),")"]})]})]})]})]}),(0,k.jsxs)("div",{className:"space-y-3 md:col-span-2",children:[(0,k.jsxs)("h4",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider flex items-center gap-2",children:[(0,k.jsx)(y,{className:"w-3.5 h-3.5"}),"Detailed Problem Description"]}),(0,k.jsx)("div",{className:"bg-white p-4 rounded-md border border-slate-200",children:(0,k.jsx)("p",{className:"text-slate-700 text-sm leading-relaxed",children:e.problem})})]}),(0,k.jsxs)("div",{className:"space-y-3 md:col-span-2",children:[(0,k.jsxs)("h4",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider flex items-center gap-2",children:[(0,k.jsx)(f.A,{className:"w-3.5 h-3.5"}),"Ticket Timeline"]}),(0,k.jsx)("div",{className:"bg-white p-4 rounded-md border border-slate-200",children:(0,k.jsxs)("div",{className:"flex flex-wrap gap-8 text-sm",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("span",{className:"text-slate-500 block text-xs mb-1",children:"Created"}),(0,k.jsx)("span",{className:"font-medium text-slate-900",children:R(e.createdAt)})]}),e.assignedAt&&(0,k.jsxs)("div",{children:[(0,k.jsx)("span",{className:"text-slate-500 block text-xs mb-1",children:"Assigned"}),(0,k.jsx)("span",{className:"font-medium text-slate-900",children:R(e.assignedAt)})]}),e.resolvedAt&&(0,k.jsxs)("div",{children:[(0,k.jsx)("span",{className:"text-slate-500 block text-xs mb-1",children:"Resolved"}),(0,k.jsx)("span",{className:"font-medium text-slate-900",children:R(e.resolvedAt)})]}),e.closedAt&&(0,k.jsxs)("div",{children:[(0,k.jsx)("span",{className:"text-slate-500 block text-xs mb-1",children:"Closed"}),(0,k.jsx)("span",{className:"font-medium text-slate-900",children:R(e.closedAt)})]})]})})]}),e.resolutionNotes&&(0,k.jsxs)("div",{className:"space-y-3 md:col-span-2",children:[(0,k.jsxs)("h4",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider flex items-center gap-2 text-emerald-700",children:[(0,k.jsx)(m.A,{className:"w-3.5 h-3.5"}),"Resolution Notes"]}),(0,k.jsx)("div",{className:"bg-emerald-50/50 p-4 rounded-md border border-emerald-100",children:(0,k.jsx)("p",{className:"text-slate-700 text-sm",children:e.resolutionNotes})})]})]})})]},V)})})]})}},4459(e,s,a){a.d(s,{A:()=>t});const t=(0,a(5228).A)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},5087(e,s,a){a.d(s,{A:()=>t});const t=(0,a(5228).A)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},6245(e,s,a){a.d(s,{A:()=>t});const t=(0,a(5228).A)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},6327(e,s,a){a.d(s,{A:()=>r});a(5043);var t=a(8783),l=a(579);function r(e){let{status:s}=e;const a=t.M2[s]||{label:s,color:"bg-neutral-100 text-neutral-700 border border-neutral-200"};return(0,l.jsx)("span",{className:"px-2.5 py-1 rounded-md text-xs font-semibold uppercase tracking-wide border ".concat(a.color),children:a.label})}},6401(e,s,a){a.d(s,{A:()=>t});const t=(0,a(5228).A)("wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z",key:"1ngwbx"}]])},7475(e,s,a){a.d(s,{A:()=>t});const t=(0,a(5228).A)("ban",[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},8646(e,s,a){a.d(s,{A:()=>t});const t=(0,a(5228).A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])}}]);
//# sourceMappingURL=980.8a9a8087.chunk.js.map